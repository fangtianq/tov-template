import{au as a,ax as u,cr as f,a2 as y,cs as j}from"./index-17a45ce3.js";import{a as i}from"./index-f1c54c8b.js";const c=()=>{let e=u(j());return{headers:{Authorization:e.SpringBootSecurityAuthorization.value.token||e.SpringBootShiroAuthorization.value.token}}},m=(e,t={},o={})=>i.post("/api".concat(e).concat(Object.keys(o).length===0?"":"?"+l.jsonToQueryString(o)),{...t},c()).catch(r=>{a.error(r.response.data)}),x=(e,t={},o={})=>i.get("/api".concat(e,"?").concat(l.jsonToQueryString(t)),c()).catch(r=>{a.error(r.response.data)}),l={jsonToQueryString(e){return Object.keys(e).map(function(t){return t+"="+e[t]}).join("&")},getQueryString(e){let t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),o=window.location.search.substr(1).match(t);return o!=null?decodeURI(o[2].toUpperCase()):null}},k=(e,t="301284")=>{let o={...e.header};const r=e.method||"get";let{ajaxTimes:n}=u(f());const g=y()();o.Authorization=g.getSessionToken,n.value++;const h=a({message:"Loading",type:"success"}),p="http://rap2api.taobao.org/app/mock/".concat(t,"/").concat(r);return new Promise((d,S)=>{i({...e,header:o,url:p+e.url}).then(s=>{d(s.data)}).catch(s=>{S(s)}).then(()=>{n.value--,(n.value===0||n.value!==0)&&h.close()})})},v={get:x,post:m};export{v as a,k as r};
