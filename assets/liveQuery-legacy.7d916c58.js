System.register(["./base-legacy.38854648.js","./button-legacy.0a7cc68f.js","./delete-legacy.53e84b21.js","./input-legacy.13394860.js","./index-legacy.c981faa3.js","./request-legacy.48eedf95.js","./index-legacy.374df017.js"],(function(e,t){"use strict";var a,s,l,n,c,r,o,u,i,d,b,v,y,p,j,O,g,m,k,f,I,S,N,w,_,x;return{setters:[null,e=>{a=e.E},e=>{s=e._},null,e=>{l=e.d,n=e.l,c=e.Y,r=e.n,o=e.x,u=e.y,i=e.au,d=e.o,b=e.P,v=e.Q,y=e.F,p=e.a7,j=e.S,O=e.U,g=e.a3,m=e.a4,k=e.w,f=e.be,I=e.bf,S=e.aF,N=e.aG,w=e.a2},e=>{_=e.a},e=>{x=e.E}],execute:function(){var t={class:"main p-4"},h={class:"message-container"},J=v("h3",null,"后台：org.sang.socket.livequery.LiveQueryController",-1),Q=v("h3",null,"https://github.com/fangtianq/FTQPriSpringbootVueBlog",-1),T={class:"mdui-card-primary"},C={class:"mdui-card-content message-content inline-block"},D={class:"inline-block"},V=l({__name:"liveQuery",setup(e){var l,V,F=n(c.REFDANMU),U={Authorization:"",ContentType:"text/LCObject"},q=null,z=r([]),E=()=>{q&&(i.success("liveQuery websocket重新连接成功..."),clearInterval(q),q=null),V=new f("/websocket"),(l=I.over(V)).connect(U,(()=>{i.success("liveQuery websocket连接成功..."),l.subscribe("/create",(e=>{z.value.push(JSON.parse(e.body))})),l.subscribe("/delete",(e=>{var t=JSON.parse(e.body).objectId;z.value=z.value.filter((e=>e.objectId!=t))})),l.subscribe("/update",(e=>{var t=JSON.parse(e.body).objectId,a=z.value.findIndex((e=>e.objectId==t));z.value[a]=JSON.parse(e.body),F.value.insert(JSON.parse(e.body).object)}))}),(e=>{q=setInterval((()=>{E()}),5e3),i.error("liveQuery websocket断线重连中...")})),_.post("/find",{className:S.TODO.name}).then((e=>{z.value=e.data.list}))};o((()=>{E()})),u((()=>{l.disconnect((()=>{V.onclose,V.close(),i.success("liveQuery websocket断开成功！")}))}));var P=()=>{var e=new(N.Object.extend(S.TODO.name));e.set(S.TODO.keys.content,"Hello world!"),e.set(S.TODO.keys.done,!0),e.set(S.TODO.keys.user,w()());var t=JSON.stringify({object:e.attributes,className:e.className});l.send("/app/saveInBackground",U,t)};return(e,n)=>{var c=x,r=s,o=a;return d(),b("div",t,[v("div",h,[J,Q,(d(!0),b(y,null,p(m(z),(e=>(d(),b("div",{key:e.objectId,class:"mdui-card",style:{margin:"10px 0",width:"500px"}},[v("div",T,[v("div",C,[j(O(e.object.user.username+"："),1),g(c,{modelValue:e.object.content,"onUpdate:modelValue":t=>e.object.content=t,clearable:"",onInput:t=>{return a=e.objectId,s=e.object,void l.send("/app/updateObject",U,JSON.stringify({objectId:a,object:s}));var a,s}},null,8,["modelValue","onUpdate:modelValue","onInput"])]),v("div",D,[g(r,{class:"relative top-1",onClick:t=>{return a=e.objectId,void l.send("/app/deleteObject",U,JSON.stringify({objectId:a}));var a}},null,8,["onClick"])])])])))),128)),g(o,{type:"primary",size:"default",onClick:P},{default:k((()=>[j("发送")])),_:1})])])}}}),F=Object.freeze(Object.defineProperty({__proto__:null,default:V},Symbol.toStringTag,{value:"Module"}));e("_",F)}}}));
