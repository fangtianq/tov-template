import{a as ee}from"./request-af25b9b6.js";import{X as A,f as C,d as B,e as S,h as I,Y as P,ar as N,l as p,p as oe,aw as ne,m as W,ax as te,o as le,a as re,w as k,x as E,A as q,y as V}from"./index-01622320.js";import{s as ie,a as se,b as ae,_ as ce}from"./Button-45634ec5.js";import{c as D,e as U,N as ue,w as K}from"./light-7b7c27c0.js";import{j as de,a as H,c as M,h as Y,b as G,u as X,f as O,e as he,g as fe}from"./use-rtl-005adc7e.js";import{f as ge}from"./fade-in-scale-up.cssr-a794635f.js";import{t as me}from"./throttle-25b140d5.js";import{_ as be}from"./Space-f0fd76ee.js";function J(e,o){const n=A(de,null);return C(()=>e.hljs||(n==null?void 0:n.mergedHljsRef.value))}const ve=e=>{const{textColor2:o,fontSize:n,fontWeightStrong:t,textColor3:a}=e;return{textColor:o,fontSize:n,fontWeightStrong:t,"mono-3":"#a0a1a7","hue-1":"#0184bb","hue-2":"#4078f2","hue-3":"#a626a4","hue-4":"#50a14f","hue-5":"#e45649","hue-5-2":"#c91243","hue-6":"#986801","hue-6-2":"#c18401",lineNumberTextColor:a}},pe={name:"Code",common:D,self:ve},Q=pe,_e=H([M("code","\n font-size: var(--n-font-size);\n font-family: var(--n-font-family);\n ",[Y("show-line-numbers","\n display: flex;\n "),G("line-numbers","\n user-select: none;\n padding-right: 12px;\n text-align: right;\n transition: color .3s var(--n-bezier);\n color: var(--n-line-number-text-color);\n "),Y("word-wrap",[H("pre","\n white-space: pre-wrap;\n word-break: break-all;\n ")]),H("pre","\n margin: 0;\n line-height: inherit;\n font-size: inherit;\n font-family: inherit;\n "),H("[class^=hljs]","\n color: var(--n-text-color);\n transition: \n color .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n ")]),({props:e})=>{const o="".concat(e.bPrefix,"code");return["".concat(o," .hljs-comment,\n ").concat(o," .hljs-quote {\n color: var(--n-mono-3);\n font-style: italic;\n }"),"".concat(o," .hljs-doctag,\n ").concat(o," .hljs-keyword,\n ").concat(o," .hljs-formula {\n color: var(--n-hue-3);\n }"),"".concat(o," .hljs-section,\n ").concat(o," .hljs-name,\n ").concat(o," .hljs-selector-tag,\n ").concat(o," .hljs-deletion,\n ").concat(o," .hljs-subst {\n color: var(--n-hue-5);\n }"),"".concat(o," .hljs-literal {\n color: var(--n-hue-1);\n }"),"".concat(o," .hljs-string,\n ").concat(o," .hljs-regexp,\n ").concat(o," .hljs-addition,\n ").concat(o," .hljs-attribute,\n ").concat(o," .hljs-meta-string {\n color: var(--n-hue-4);\n }"),"".concat(o," .hljs-built_in,\n ").concat(o," .hljs-class .hljs-title {\n color: var(--n-hue-6-2);\n }"),"".concat(o," .hljs-attr,\n ").concat(o," .hljs-variable,\n ").concat(o," .hljs-template-variable,\n ").concat(o," .hljs-type,\n ").concat(o," .hljs-selector-class,\n ").concat(o," .hljs-selector-attr,\n ").concat(o," .hljs-selector-pseudo,\n ").concat(o," .hljs-number {\n color: var(--n-hue-6);\n }"),"".concat(o," .hljs-symbol,\n ").concat(o," .hljs-bullet,\n ").concat(o," .hljs-link,\n ").concat(o," .hljs-meta,\n ").concat(o," .hljs-selector-id,\n ").concat(o," .hljs-title {\n color: var(--n-hue-2);\n }"),"".concat(o," .hljs-emphasis {\n font-style: italic;\n }"),"".concat(o," .hljs-strong {\n font-weight: var(--n-font-weight-strong);\n }"),"".concat(o," .hljs-link {\n text-decoration: underline;\n }")]}]),xe=Object.assign(Object.assign({},O.props),{language:String,code:{type:String,default:""},trim:{type:Boolean,default:!0},hljs:Object,uri:Boolean,inline:Boolean,wordWrap:Boolean,showLineNumbers:Boolean,internalFontSize:Number,internalNoHighlight:Boolean}),je=B({name:"Code",props:xe,setup(e,{slots:o}){const{internalNoHighlight:n}=e,{mergedClsPrefixRef:t,inlineThemeDisabled:a}=X(),c=S(null),d=n?{value:void 0}:J(e),r=(l,f,h)=>{const{value:g}=d;return!g||!(l&&g.getLanguage(l))?null:g.highlight(h?f.trim():f,{language:l}).value},R=C(()=>e.inline||e.wordWrap?!1:e.showLineNumbers),v=()=>{if(o.default)return;const{value:l}=c;if(!l)return;const{language:f}=e,h=e.uri?window.decodeURIComponent(e.code):e.code;if(f){const u=r(f,h,e.trim);if(u!==null){if(e.inline)l.innerHTML=u;else{const i=l.querySelector(".__code__");i&&l.removeChild(i);const s=document.createElement("pre");s.className="__code__",s.innerHTML=u,l.appendChild(s)}return}}if(e.inline){l.textContent=h;return}const g=l.querySelector(".__code__");if(g)g.textContent=h;else{const u=document.createElement("pre");u.className="__code__",u.textContent=h,l.innerHTML="",l.appendChild(u)}};I(v),P(N(e,"language"),v),P(N(e,"code"),v),n||P(d,v);const y=O("Code","-code",_e,Q,e,t),T=C(()=>{const{common:{cubicBezierEaseInOut:l,fontFamilyMono:f},self:{textColor:h,fontSize:g,fontWeightStrong:u,lineNumberTextColor:i,"mono-3":s,"hue-1":x,"hue-2":j,"hue-3":m,"hue-4":w,"hue-5":L,"hue-5-2":z,"hue-6":$,"hue-6-2":b}}=y.value,{internalFontSize:F}=e;return{"--n-font-size":F?"".concat(F,"px"):g,"--n-font-family":f,"--n-font-weight-strong":u,"--n-bezier":l,"--n-text-color":h,"--n-mono-3":s,"--n-hue-1":x,"--n-hue-2":j,"--n-hue-3":m,"--n-hue-4":w,"--n-hue-5":L,"--n-hue-5-2":z,"--n-hue-6":$,"--n-hue-6-2":b,"--n-line-number-text-color":i}}),_=a?U("code",C(()=>"".concat(e.internalFontSize||"a")),T,e):void 0;return{mergedClsPrefix:t,codeRef:c,mergedShowLineNumbers:R,lineNumbers:C(()=>{let l=1;const f=[];let h=!1;for(const g of e.code)g==="\n"?(h=!0,f.push(l++)):h=!1;return h||f.push(l++),f.join("\n")}),cssVars:a?void 0:T,themeClass:_==null?void 0:_.themeClass,onRender:_==null?void 0:_.onRender}},render(){var e,o;const{mergedClsPrefix:n,wordWrap:t,mergedShowLineNumbers:a,onRender:c}=this;return c==null||c(),p("code",{class:["".concat(n,"-code"),this.themeClass,t&&"".concat(n,"-code--word-wrap"),a&&"".concat(n,"-code--show-line-numbers")],style:this.cssVars,ref:"codeRef"},a?p("pre",{class:"".concat(n,"-code__line-numbers")},this.lineNumbers):null,(o=(e=this.$slots).default)===null||o===void 0?void 0:o.call(e))}}),$e=e=>{const{textColor2:o,modalColor:n,borderColor:t,fontSize:a,primaryColor:c}=e;return{loaderFontSize:a,loaderTextColor:o,loaderColor:n,loaderBorder:"1px solid ".concat(t),loadingColor:c}},Ce=he({name:"Log",common:D,peers:{Scrollbar:ie,Code:Q},self:$e}),Re=Ce,ye=B({name:"LogLoader",props:{clsPrefix:{type:String,required:!0}},setup(){return{locale:se("Log").localeRef}},render(){const{clsPrefix:e}=this;return p("div",{class:"".concat(e,"-log-loader")},p(ue,{clsPrefix:e,strokeWidth:24,scale:.85}),p("span",{class:"".concat(e,"-log-loader__content")},this.locale.loading))}}),Z=fe("n-log"),Te=B({props:{line:{type:String,default:""}},setup(e){const{trimRef:o,highlightRef:n,languageRef:t,mergedHljsRef:a}=A(Z),c=S(null),d=C(()=>o.value?e.line.trim():e.line);function r(){c.value&&(c.value.innerHTML=R(t.value,d.value))}function R(v,y){const{value:T}=a;return T&&v&&T.getLanguage(v)?T.highlight(y,{language:v}).value:y}return I(()=>{n.value&&r()}),P(N(e,"line"),()=>{n.value&&r()}),{highlight:n,selfRef:c,maybeTrimmedLines:d}},render(){const{highlight:e,maybeTrimmedLines:o}=this;return p("pre",{ref:"selfRef"},e?null:o)}}),we=M("log","\n position: relative;\n box-sizing: border-box;\n transition: border-color .3s var(--n-bezier);\n",[H("pre","\n white-space: pre-wrap;\n word-break: break-word;\n margin: 0;\n "),M("log-loader","\n transition:\n color .3s var(--n-bezier),\n background-color .3s var(--n-bezier),\n border-color .3s var(--n-bezier);\n box-sizing: border-box;\n position: absolute;\n right: 16px;\n top: 8px;\n height: 34px;\n border-radius: 17px;\n line-height: 34px;\n white-space: nowrap;\n overflow: hidden;\n border: var(--n-loader-border);\n color: var(--n-loader-text-color);\n background-color: var(--n-loader-color);\n font-size: var(--n-loader-font-size);\n ",[ge(),G("content","\n display: inline-block;\n vertical-align: bottom;\n line-height: 34px;\n padding-left: 40px;\n padding-right: 20px;\n white-space: nowrap;\n "),M("base-loading","\n color: var(--n-loading-color);\n position: absolute;\n left: 12px;\n top: calc(50% - 10px);\n font-size: 20px;\n width: 20px;\n height: 20px;\n display: inline-block;\n ")])]),Se=Object.assign(Object.assign({},O.props),{loading:Boolean,trim:Boolean,log:String,fontSize:{type:Number,default:14},lines:{type:Array,default:()=>[]},lineHeight:{type:Number,default:1.25},language:String,rows:{type:Number,default:15},offsetTop:{type:Number,default:0},offsetBottom:{type:Number,default:0},hljs:Object,onReachTop:Function,onReachBottom:Function,onRequireMore:Function}),Le=B({name:"Log",props:Se,setup(e){const{mergedClsPrefixRef:o,inlineThemeDisabled:n}=X(e),t=S(!1),a=C(()=>e.language!==void 0),c=C(()=>"calc(".concat(Math.round(e.rows*e.lineHeight*e.fontSize),"px)")),d=C(()=>{const{log:i}=e;return i?i.split("\n"):e.lines}),r=S(null),R=O("Log","-log",we,Re,e,o);function v(i){const s=i.target,x=s.firstElementChild;if(t.value){W(()=>{t.value=!1});return}const j=s.offsetHeight,m=s.scrollTop,w=x.offsetHeight,L=m,z=w-m-j;if(L<=e.offsetTop){const{onReachTop:$,onRequireMore:b}=e;b&&b("top"),$&&$()}if(z<=e.offsetBottom){const{onReachBottom:$,onRequireMore:b}=e;b&&b("bottom"),$&&$()}}const y=me(T,300);function T(i){if(t.value){W(()=>{t.value=!1});return}if(r.value){const{containerRef:s,contentRef:x}=r.value;if(s&&x){const j=s.offsetHeight,m=s.scrollTop,w=x.offsetHeight,L=m,z=w-m-j,$=i.deltaY;if(L===0&&$<0){const{onRequireMore:b}=e;b&&b("top")}if(z<=0&&$>0){const{onRequireMore:b}=e;b&&b("bottom")}}}}function _(i){const{value:s}=r;if(!s)return;const{silent:x,top:j,position:m}=i;x&&(t.value=!0),j!==void 0?s.scrollTo({left:0,top:j}):(m==="bottom"||m==="top")&&s.scrollTo({position:m})}function l(i=!1){K("log","`scrollToTop` is deprecated, please use `scrollTo({ position: 'top'})` instead."),_({position:"top",silent:i})}function f(i=!1){K("log","`scrollToTop` is deprecated, please use `scrollTo({ position: 'bottom'})` instead."),_({position:"bottom",silent:i})}oe(Z,{languageRef:N(e,"language"),mergedHljsRef:J(e),trimRef:N(e,"trim"),highlightRef:a});const h={scrollTo:_},g=C(()=>{const{self:{loaderFontSize:i,loaderTextColor:s,loaderColor:x,loaderBorder:j,loadingColor:m},common:{cubicBezierEaseInOut:w}}=R.value;return{"--n-bezier":w,"--n-loader-font-size":i,"--n-loader-border":j,"--n-loader-color":x,"--n-loader-text-color":s,"--n-loading-color":m}}),u=n?U("log",void 0,g,e):void 0;return Object.assign(Object.assign({},h),{mergedClsPrefix:o,scrollbarRef:r,mergedTheme:R,styleHeight:c,mergedLines:d,scrollToTop:l,scrollToBottom:f,handleWheel:y,handleScroll:v,cssVars:n?void 0:g,themeClass:u==null?void 0:u.themeClass,onRender:u==null?void 0:u.onRender})},render(){const{mergedClsPrefix:e,mergedTheme:o,onRender:n}=this;return n==null||n(),p("div",{class:["".concat(e,"-log"),this.themeClass],style:[{lineHeight:this.lineHeight,height:this.styleHeight},this.cssVars],onWheelPassive:this.handleWheel},[p(ae,{ref:"scrollbarRef",theme:o.peers.Scrollbar,themeOverrides:o.peerOverrides.Scrollbar,onScroll:this.handleScroll},{default:()=>p(je,{internalNoHighlight:!0,internalFontSize:this.fontSize,theme:o.peers.Code,themeOverrides:o.peerOverrides.Code},{default:()=>this.mergedLines.map((t,a)=>p(Te,{key:a,line:t}))})}),p(ne,{name:"fade-in-scale-up-transition"},{default:()=>this.loading?p(ye,{clsPrefix:e}):null})])}}),ze=B({__name:"实时日志",setup(e){const o=S(!0);function n(){let d=new EventSource("/api/log/find");d.onmessage=function(r){r.data,t.value=t.value+r.data+"\r\n"},d.onopen=function(){},d.onerror=function(r){d.close()},d.addEventListener("myEvent",function(r){r.data},!1)}const t=S(""),a=()=>{ee.get("/log/logSomethingGet",{}).then(()=>{})},c=S();return I(()=>{te(t,d=>{var r;(r=c.value)==null||r.scrollTo({position:"bottom",slient:!0})}),n()}),(d,r)=>{const R=ce,v=Le,y=be;return le(),re("div",null,[k(y,{vertical:"",class:"px-8 h-screen"},{default:E(()=>[k(R,{onClick:a},{default:E(()=>[q(" 添加数据 ")]),_:1}),k(R,{disabled:!0,onClick:n},{default:E(()=>[q(" Flux ")]),_:1}),k(v,{ref_key:"logInst",ref:c,loading:V(o),log:V(t),rows:45},null,8,["loading","log"])]),_:1})])}}}),Ie=Object.freeze(Object.defineProperty({__proto__:null,default:ze},Symbol.toStringTag,{value:"Module"}));export{Ie as _};
