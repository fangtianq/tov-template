import{a as F}from"./index.0c6ae40e.js";import{j as g,e as v,f as r,d as B,ak as _,l as C,am as N,i as t,w as n,bg as $,I as h,h as U,k as m,t as M,n as T,aa as L,m as A,aq as u,bh as D}from"./index.f34240a3.js";import{E as R,a as j}from"./el-form-item.395e8d06.js";import{E as q}from"./el-popover.e51d70e0.js";import"./el-popper.848c232f.js";import{E as z}from"./el-button.9d8893f6.js";import{E as Z}from"./el-input.2c599987.js";import{_ as G}from"./favicon.eb9475ba.js";import{b}from"./route-block.6a611cbf.js";import"./error.7e8331f1.js";import"./index.1bb8179e.js";import"./index.8bfffa1c.js";const H={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},J=r("path",{fill:"currentColor",d:"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59L21 7Z"},null,-1),K=[J];function O(w,e){return g(),v("svg",H,K)}const Q={name:"mdi-check",render:O},W={class:"bg-white h-screen font-github"},X={class:"flex justify-center items-center flex-col"},Y=r("div",{class:"p-8"},[r("img",{src:G,class:"w-12 h-12",alt:"tov"})],-1),ee=r("div",{class:"font-300 text-2xl tracking-github mb-4"}," Sign up to tov-template ",-1),se={class:"h-98 w-77 bg-github_bg border-github_b rounded-xl border-1 p-4"},oe={class:"w-max h-max cursor-pointer"},te=["src"],ae=r("div",{class:"mt-3 w-77 bg-white border-github_b rounded-xl border-1 p-4"},[m(" Already have an account? "),r("a",{href:"login",class:"text-github_a"}," Sign in \u2192 "),m(" . ")],-1),le=B({__name:"signup",setup(w){F.get("api/article/all").then(a=>{});const e=_({username:"",password:"",checkPass:"",nickName:"",smsCodeInput:"",smsCode:"",smsCodeVisible:!1,smsCodeCanSend:!1,smsCodeTip:"\u5237\u65B0\u9A8C\u8BC1\u7801",captcha:C()}),p=a=>{e.smsCodeVisible=a},V=()=>{p(!0),e.smsCodeCanSend=!1,$().then(a=>{e.smsCode=a.url,e.captcha=a})},c=N.debounce(V,1e3,{leading:!0,trailing:!1}),k=A(),S=()=>{var a;e.smsCodeInput==""||e.smsCodeInput.length!=4||(a=e.captcha)==null||a.verify(e.smsCodeInput).then(s=>{p(!1),e.smsCodeCanSend=!0,e.smsCodeVisible=!1},s=>{s.code=="800"?c():u.error(s.rawMessage)}).catch(s=>{u.error(s)})},x=_({password:[{validator:(a,s,o)=>{if(s==="")o(new Error("Please input the password"));else{if(e.checkPass!==""){if(!d.value)return;d.value.validateField("checkPass",()=>null)}o()}},trigger:"blur"}],checkPass:[{validator:(a,s,o)=>{s===""?o(new Error("Please input the password again")):s!==e.password?o(new Error("Two inputs don't match!")):o()},trigger:"blur"}],smsCodeInput:[{validator:(a,s,o)=>{e.smsCodeCanSend?o():o(new Error("SmsCode don't match!"))},trigger:"blur"}]}),d=C(),E=a=>{!a||a.validate(s=>{if(s)D()(e.username,e.password).then(o=>{u.success("\u6CE8\u518C\u6210\u529F"),k.push("login")},o=>{u.error(`\u6CE8\u518C\u5931\u8D25\uFF1A${o.rawMessage}`)});else return!1})};return(a,s)=>{const o=Z,i=R,P=Q,f=z,I=q,y=j;return g(),v("div",W,[t(y,{ref_key:"ruleFormRef",ref:d,model:e,"label-position":"top",rules:x},{default:n(()=>[r("div",X,[Y,ee,r("div",se,[t(i,{label:"Phone number"},{default:n(()=>[t(o,{modelValue:e.username,"onUpdate:modelValue":s[0]||(s[0]=l=>e.username=l)},null,8,["modelValue"])]),_:1}),t(i,{label:"Password",prop:"password"},{default:n(()=>[t(o,{modelValue:e.password,"onUpdate:modelValue":s[1]||(s[1]=l=>e.password=l),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(i,{label:"Confirm",prop:"checkPass"},{default:n(()=>[t(o,{modelValue:e.checkPass,"onUpdate:modelValue":s[2]||(s[2]=l=>e.checkPass=l),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(i,{label:"nickName"},{default:n(()=>[t(o,{modelValue:e.nickName,"onUpdate:modelValue":s[3]||(s[3]=l=>e.nickName=l)},null,8,["modelValue"])]),_:1}),t(i,{prop:"smsCodeInput"},{default:n(()=>[t(I,{visible:e.smsCodeVisible,placement:"top"},{reference:n(()=>[t(f,{id:"verify",class:h("text-github_a mb-1"),onClick:U(c)},{default:n(()=>[r("span",{class:h(e.smsCodeCanSend?"text-green-500":"")},[m(M(e.smsCodeTip)+" ",1),T(t(P,null,null,512),[[L,e.smsCodeCanSend]])],2)]),_:1},8,["onClick"])]),default:n(()=>[r("div",oe,[r("img",{src:e.smsCode},null,8,te)])]),_:1},8,["visible"]),t(o,{modelValue:e.smsCodeInput,"onUpdate:modelValue":s[4]||(s[4]=l=>e.smsCodeInput=l),modelModifiers:{trim:!0},class:"w-8",disabled:!e.smsCodeVisible,onFocus:s[5]||(s[5]=l=>p(!0)),onInput:s[6]||(s[6]=l=>S())},null,8,["modelValue","disabled"])]),_:1}),t(i,null,{default:n(()=>[t(f,{class:"w-full rounded-2xl shadow-github_button",color:"#2da44e",type:"primary",onClick:s[7]||(s[7]=l=>E(d.value))},{default:n(()=>[m("Sign up")]),_:1})]),_:1})]),ae])]),_:1},8,["model","rules"])])}}});typeof b=="function"&&b(le);export{le as default};
