/* empty css             *//* empty css              *//* empty css            */import{_ as je,E as pe,a as xe,s as Fe}from"./select-68470c1e.js";import"./scrollbar-8c832c1f.js";import"./popper-bad9a22d.js";import{E as Re,p as ae}from"./checkbox-8ebd1e6d.js";import{_ as He}from"./rolePermissionModify.vue_vue_type_script_setup_true_lang-bdd01a33.js";import{a as ce}from"./request-ca3158a4.js";import{bq as ye,s as te,M as _e,a as ie,d as V,u as U,l as H,z as G,v as J,n as D,f as ue,e as Ue,B as We,aL as Ye,k as be,t as x,N as _,cG as Qe,r as A,C as ge,D as ke,o as w,P as B,Q as re,c as P,w as q,al as Ge,R as O,aM as I,a8 as Q,a3 as T,a9 as Je,F as Ke,a7 as Ee,aV as Oe,A as Xe,ai as Ae,x as De,bR as Ze,bQ as et,E as $,j as tt,aY as nt,g as L,b as ot,U as Me,bn as Le,S as st,a4 as he,ac as dt,au as at}from"./index-08a94d7c.js";import{f as rt}from"./constants-0b468837.js";import{U as fe}from"./event-1da57d2d.js";import{i as it}from"./isEqual-a74b9ffd.js";import{_ as lt}from"./Tag-38d73543.js";const R="$treeNodeId",Te=function(e,t){!t||t[R]||Object.defineProperty(t,R,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},we=function(e,t){return e?t[e]:t[R]},Ne=(e,t,o)=>{const s=e.value.currentNode;o();const n=e.value.currentNode;s!==n&&t("current-change",n?n.data:null,n)},Ce=e=>{let t=!0,o=!0,s=!0;for(let n=0,d=e.length;n<d;n++){const i=e[n];(i.checked!==!0||i.indeterminate)&&(t=!1,i.disabled||(s=!1)),(i.checked!==!1||i.indeterminate)&&(o=!1)}return{all:t,none:o,allWithoutDisable:s,half:!t&&!o}},ne=function(e){if(e.childNodes.length===0||e.loading)return;const{all:t,none:o,half:s}=Ce(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):s?(e.checked=!1,e.indeterminate=!0):o&&(e.checked=!1,e.indeterminate=!1);const n=e.parent;!n||n.level===0||e.store.checkStrictly||ne(n)},ee=function(e,t){const o=e.store.props,s=e.data||{},n=o[t];if(typeof n=="function")return n(s,e);if(typeof n=="string")return s[n];if(typeof n>"u"){const d=s[t];return d===void 0?"":d}};let ct=0;class z{constructor(t){this.id=ct++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const o in t)ye(t,o)&&(this[o]=t[o]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const o=t.props;if(o&&typeof o.isLeaf<"u"){const d=ee(this,"isLeaf");typeof d=="boolean"&&(this.isLeafByUser=d)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&this.expand(),Array.isArray(this.data)||Te(this,this.data),!this.data)return;const s=t.defaultExpandedKeys,n=t.key;n&&s&&s.includes(this.key)&&this.expand(null,t.autoExpandParent),n&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){Array.isArray(t)||Te(this,t),this.data=t,this.childNodes=[];let o;this.level===0&&Array.isArray(this.data)?o=this.data:o=ee(this,"children")||[];for(let s=0,n=o.length;s<n;s++)this.insertChild({data:o[s]})}get label(){return ee(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return ee(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const o=t.childNodes.indexOf(this);if(o>-1)return t.childNodes[o+1]}return null}get previousSibling(){const t=this.parent;if(t){const o=t.childNodes.indexOf(this);if(o>-1)return o>0?t.childNodes[o-1]:null}return null}contains(t,o=!0){return(this.childNodes||[]).some(s=>s===t||o&&s.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,o,s){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof z)){if(!s){const n=this.getChildren(!0);n.includes(t.data)||(typeof o>"u"||o<0?n.push(t.data):n.splice(o,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=te(new z(t)),t instanceof z&&t.initialize()}t.level=this.level+1,typeof o>"u"||o<0?this.childNodes.push(t):this.childNodes.splice(o,0,t),this.updateLeafState()}insertBefore(t,o){let s;o&&(s=this.childNodes.indexOf(o)),this.insertChild(t,s)}insertAfter(t,o){let s;o&&(s=this.childNodes.indexOf(o),s!==-1&&(s+=1)),this.insertChild(t,s)}removeChild(t){const o=this.getChildren()||[],s=o.indexOf(t.data);s>-1&&o.splice(s,1);const n=this.childNodes.indexOf(t);n>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(n,1)),this.updateLeafState()}removeChildByData(t){let o=null;for(let s=0;s<this.childNodes.length;s++)if(this.childNodes[s].data===t){o=this.childNodes[s];break}o&&this.removeChild(o)}expand(t,o){const s=()=>{if(o){let n=this.parent;for(;n.level>0;)n.expanded=!0,n=n.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(n=>{n.canFocus=!0})};this.shouldLoadData()?this.loadData(n=>{Array.isArray(n)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||ne(this),s())}):s()}doCreateChildren(t,o={}){t.forEach(s=>{this.insertChild(Object.assign({data:s},o),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const t=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!t||t.length===0;return}this.isLeaf=!1}setChecked(t,o,s,n){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:i,allWithoutDisable:r}=Ce(this.childNodes);!this.isLeaf&&!i&&r&&(this.checked=!1,t=!1);const c=()=>{if(o){const y=this.childNodes;for(let a=0,l=y.length;a<l;a++){const f=y[a];n=n||t!==!1;const k=f.disabled?f.checked:n;f.setChecked(k,o,!0,n)}const{half:p,all:u}=Ce(y);u||(this.checked=u,this.indeterminate=p)}};if(this.shouldLoadData()){this.loadData(()=>{c(),ne(this)},{checked:t!==!1});return}else c()}const d=this.parent;!d||d.level===0||s||ne(d)}getChildren(t=!1){if(this.level===0)return this.data;const o=this.data;if(!o)return null;const s=this.store.props;let n="children";return s&&(n=s.children||"children"),o[n]===void 0&&(o[n]=null),t&&!o[n]&&(o[n]=[]),o[n]}updateChildren(){const t=this.getChildren()||[],o=this.childNodes.map(d=>d.data),s={},n=[];t.forEach((d,i)=>{const r=d[R];!!r&&o.findIndex(y=>y[R]===r)>=0?s[r]={index:i,data:d}:n.push({index:i,data:d})}),this.store.lazy||o.forEach(d=>{s[d[R]]||this.removeChildByData(d)}),n.forEach(({index:d,data:i})=>{this.insertChild({data:i},d)}),this.updateLeafState()}loadData(t,o={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(o).length)){this.loading=!0;const s=n=>{this.childNodes=[],this.doCreateChildren(n,o),this.loaded=!0,this.loading=!1,this.updateLeafState(),t&&t.call(this,n)};this.store.load(this,s)}else t&&t.call(this)}}class ut{constructor(t){this.currentNode=null,this.currentNodeKey=null;for(const o in t)ye(t,o)&&(this[o]=t[o]);this.nodesMap={}}initialize(){if(this.root=new z({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const t=this.load;t(this.root,o=>{this.root.doCreateChildren(o),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(t){const o=this.filterNodeMethod,s=this.lazy,n=function(d){const i=d.root?d.root.childNodes:d.childNodes;if(i.forEach(r=>{r.visible=o.call(r,t,r.data,r),n(r)}),!d.visible&&i.length){let r=!0;r=!i.some(c=>c.visible),d.root?d.root.visible=r===!1:d.visible=r===!1}t&&d.visible&&!d.isLeaf&&!s&&d.expand()};n(this)}setData(t){t!==this.root.data?(this.root.setData(t),this._initDefaultCheckedNodes()):this.root.updateChildren()}getNode(t){if(t instanceof z)return t;const o=_e(t)?we(this.key,t):t;return this.nodesMap[o]||null}insertBefore(t,o){const s=this.getNode(o);s.parent.insertBefore({data:t},s)}insertAfter(t,o){const s=this.getNode(o);s.parent.insertAfter({data:t},s)}remove(t){const o=this.getNode(t);o&&o.parent&&(o===this.currentNode&&(this.currentNode=null),o.parent.removeChild(o))}append(t,o){const s=o?this.getNode(o):this.root;s&&s.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],o=this.nodesMap;t.forEach(s=>{const n=o[s];n&&n.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const o=this.key;!t||!t.data||(o?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(s=>{this.deregisterNode(s)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,o=!1){const s=[],n=function(d){(d.root?d.root.childNodes:d.childNodes).forEach(r=>{(r.checked||o&&r.indeterminate)&&(!t||t&&r.isLeaf)&&s.push(r.data),n(r)})};return n(this),s}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(o=>(o||{})[this.key])}getHalfCheckedNodes(){const t=[],o=function(s){(s.root?s.root.childNodes:s.childNodes).forEach(d=>{d.indeterminate&&t.push(d.data),o(d)})};return o(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],o=this.nodesMap;for(const s in o)ye(o,s)&&t.push(o[s]);return t}updateChildren(t,o){const s=this.nodesMap[t];if(!s)return;const n=s.childNodes;for(let d=n.length-1;d>=0;d--){const i=n[d];this.remove(i.data)}for(let d=0,i=o.length;d<i;d++){const r=o[d];this.append(r,s.data)}}_setCheckedKeys(t,o=!1,s){const n=this._getAllNodes().sort((r,c)=>c.level-r.level),d=Object.create(null),i=Object.keys(s);n.forEach(r=>r.setChecked(!1,!1));for(let r=0,c=n.length;r<c;r++){const y=n[r],p=y.data[t].toString();if(!i.includes(p)){y.checked&&!d[p]&&y.setChecked(!1,!1);continue}let a=y.parent;for(;a&&a.level>0;)d[a.data[t]]=!0,a=a.parent;if(y.isLeaf||this.checkStrictly){y.setChecked(!0,!1);continue}if(y.setChecked(!0,!0),o){y.setChecked(!1,!1);const l=function(f){f.childNodes.forEach(C=>{C.isLeaf||C.setChecked(!1,!1),l(C)})};l(y)}}}setCheckedNodes(t,o=!1){const s=this.key,n={};t.forEach(d=>{n[(d||{})[s]]=!0}),this._setCheckedKeys(s,o,n)}setCheckedKeys(t,o=!1){this.defaultCheckedKeys=t;const s=this.key,n={};t.forEach(d=>{n[d]=!0}),this._setCheckedKeys(s,o,n)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(o=>{const s=this.getNode(o);s&&s.expand(null,this.autoExpandParent)})}setChecked(t,o,s){const n=this.getNode(t);n&&n.setChecked(!!o,s)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const o=this.currentNode;o&&(o.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,o=!0){const s=t[this.key],n=this.nodesMap[s];this.setCurrentNode(n),o&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,o=!0){if(t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const s=this.getNode(t);s&&(this.setCurrentNode(s),o&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const ht=V({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=U("tree"),o=H("NodeInstance"),s=H("RootTree");return()=>{const n=e.node,{data:d,store:i}=n;return e.renderContent?e.renderContent(G,{_self:o,node:n,data:d,store:i}):s.ctx.slots.default?s.ctx.slots.default({node:n,data:d}):G("span",{class:t.be("node","label")},[n.label])}}});var ft=ie(ht,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree-node-content.vue"]]);function Be(e){const t=H("TreeNodeMap",null),o={treeNodeExpand:s=>{e.node!==s&&e.node.collapse()},children:[]};return t&&t.children.push(o),J("TreeNodeMap",o),{broadcastExpanded:s=>{if(e.accordion)for(const n of o.children)n.treeNodeExpand(s)}}}const Ie=Symbol("dragEvents");function pt({props:e,ctx:t,el$:o,dropIndicator$:s,store:n}){const d=U("tree"),i=D({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return J(Ie,{treeNodeDragStart:({event:p,treeNode:u})=>{if(typeof e.allowDrag=="function"&&!e.allowDrag(u.node))return p.preventDefault(),!1;p.dataTransfer.effectAllowed="move";try{p.dataTransfer.setData("text/plain","")}catch(a){}i.value.draggingNode=u,t.emit("node-drag-start",u.node,p)},treeNodeDragOver:({event:p,treeNode:u})=>{const a=u,l=i.value.dropNode;l&&l.node.id!==a.node.id&&ue(l.$el,d.is("drop-inner"));const f=i.value.draggingNode;if(!f||!a)return;let k=!0,C=!0,m=!0,b=!0;typeof e.allowDrop=="function"&&(k=e.allowDrop(f.node,a.node,"prev"),b=C=e.allowDrop(f.node,a.node,"inner"),m=e.allowDrop(f.node,a.node,"next")),p.dataTransfer.dropEffect=C||k||m?"move":"none",(k||C||m)&&(l==null?void 0:l.node.id)!==a.node.id&&(l&&t.emit("node-drag-leave",f.node,l.node,p),t.emit("node-drag-enter",f.node,a.node,p)),(k||C||m)&&(i.value.dropNode=a),a.node.nextSibling===f.node&&(m=!1),a.node.previousSibling===f.node&&(k=!1),a.node.contains(f.node,!1)&&(C=!1),(f.node===a.node||f.node.contains(a.node))&&(k=!1,C=!1,m=!1);const S=a.$el.querySelector(".".concat(d.be("node","content"))).getBoundingClientRect(),M=o.value.getBoundingClientRect();let v;const X=k?C?.25:m?.45:1:-1,Z=m?C?.75:k?.55:0:1;let j=-9999;const g=p.clientY-S.top;g<S.height*X?v="before":g>S.height*Z?v="after":C?v="inner":v="none";const K=a.$el.querySelector(".".concat(d.be("node","expand-icon"))).getBoundingClientRect(),E=s.value;v==="before"?j=K.top-M.top:v==="after"&&(j=K.bottom-M.top),E.style.top="".concat(j,"px"),E.style.left="".concat(K.right-M.left,"px"),v==="inner"?Ue(a.$el,d.is("drop-inner")):ue(a.$el,d.is("drop-inner")),i.value.showDropIndicator=v==="before"||v==="after",i.value.allowDrop=i.value.showDropIndicator||b,i.value.dropType=v,t.emit("node-drag-over",f.node,a.node,p)},treeNodeDragEnd:p=>{const{draggingNode:u,dropType:a,dropNode:l}=i.value;if(p.preventDefault(),p.dataTransfer.dropEffect="move",u&&l){const f={data:u.node.data};a!=="none"&&u.node.remove(),a==="before"?l.node.parent.insertBefore(f,l.node):a==="after"?l.node.parent.insertAfter(f,l.node):a==="inner"&&l.node.insertChild(f),a!=="none"&&n.value.registerNode(f),ue(l.$el,d.is("drop-inner")),t.emit("node-drag-end",u.node,l.node,a,p),a!=="none"&&t.emit("node-drop",u.node,l.node,a,p)}u&&!l&&t.emit("node-drag-end",u.node,null,a,p),i.value.showDropIndicator=!1,i.value.draggingNode=null,i.value.dropNode=null,i.value.allowDrop=!0}}),{dragState:i}}const yt=V({name:"ElTreeNode",components:{ElCollapseTransition:je,ElCheckbox:Re,NodeContent:ft,ElIcon:We,Loading:Ye},props:{node:{type:z,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const o=U("tree"),{broadcastExpanded:s}=Be(e),n=H("RootTree"),d=D(!1),i=D(!1),r=D(null),c=D(null),y=D(null),p=H(Ie),u=be();J("NodeInstance",u),e.node.expanded&&(d.value=!0,i.value=!0);const a=n.props.props.children||"children";x(()=>{const g=e.node.data[a];return g&&[...g]},()=>{e.node.updateChildren()}),x(()=>e.node.indeterminate,g=>{k(e.node.checked,g)}),x(()=>e.node.checked,g=>{k(g,e.node.indeterminate)}),x(()=>e.node.expanded,g=>{_(()=>d.value=g),g&&(i.value=!0)});const l=g=>we(n.props.nodeKey,g.data),f=g=>{const K=e.props.class;if(!K)return{};let E;if(Oe(K)){const{data:le}=g;E=K(le,g)}else E=K;return Xe(E)?{[E]:!0}:E},k=(g,K)=>{(r.value!==g||c.value!==K)&&n.ctx.emit("check-change",e.node.data,g,K),r.value=g,c.value=K},C=g=>{Ne(n.store,n.ctx.emit,()=>n.store.value.setCurrentNode(e.node)),n.currentNode.value=e.node,n.props.expandOnClickNode&&b(),n.props.checkOnClickNode&&!e.node.disabled&&S(null,{target:{checked:!e.node.checked}}),n.ctx.emit("node-click",e.node.data,e.node,u,g)},m=g=>{n.instance.vnode.props.onNodeContextmenu&&(g.stopPropagation(),g.preventDefault()),n.ctx.emit("node-contextmenu",g,e.node.data,e.node,u)},b=()=>{e.node.isLeaf||(d.value?(n.ctx.emit("node-collapse",e.node.data,e.node,u),e.node.collapse()):(e.node.expand(),t.emit("node-expand",e.node.data,e.node,u)))},S=(g,K)=>{e.node.setChecked(K.target.checked,!n.props.checkStrictly),_(()=>{const E=n.store.value;n.ctx.emit("check",e.node.data,{checkedNodes:E.getCheckedNodes(),checkedKeys:E.getCheckedKeys(),halfCheckedNodes:E.getHalfCheckedNodes(),halfCheckedKeys:E.getHalfCheckedKeys()})})};return{ns:o,node$:y,tree:n,expanded:d,childNodeRendered:i,oldChecked:r,oldIndeterminate:c,getNodeKey:l,getNodeClass:f,handleSelectChange:k,handleClick:C,handleContextMenu:m,handleExpandIconClick:b,handleCheckChange:S,handleChildNodeExpand:(g,K,E)=>{s(K),n.ctx.emit("node-expand",g,K,E)},handleDragStart:g=>{n.props.draggable&&p.treeNodeDragStart({event:g,treeNode:e})},handleDragOver:g=>{g.preventDefault(),n.props.draggable&&p.treeNodeDragOver({event:g,treeNode:{$el:y.value,node:e.node}})},handleDrop:g=>{g.preventDefault()},handleDragEnd:g=>{n.props.draggable&&p.treeNodeDragEnd(g)},CaretRight:Qe}}}),gt=["aria-expanded","aria-disabled","aria-checked","draggable","data-key"],kt=["aria-expanded"];function Nt(e,t,o,s,n,d){const i=A("el-icon"),r=A("el-checkbox"),c=A("loading"),y=A("node-content"),p=A("el-tree-node"),u=A("el-collapse-transition");return ge((w(),B("div",{ref:"node$",class:O([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:t[1]||(t[1]=I((...a)=>e.handleClick&&e.handleClick(...a),["stop"])),onContextmenu:t[2]||(t[2]=(...a)=>e.handleContextMenu&&e.handleContextMenu(...a)),onDragstart:t[3]||(t[3]=I((...a)=>e.handleDragStart&&e.handleDragStart(...a),["stop"])),onDragover:t[4]||(t[4]=I((...a)=>e.handleDragOver&&e.handleDragOver(...a),["stop"])),onDragend:t[5]||(t[5]=I((...a)=>e.handleDragEnd&&e.handleDragEnd(...a),["stop"])),onDrop:t[6]||(t[6]=I((...a)=>e.handleDrop&&e.handleDrop(...a),["stop"]))},[re("div",{class:O(e.ns.be("node","content")),style:Je({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(w(),P(i,{key:0,class:O([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:I(e.handleExpandIconClick,["stop"])},{default:q(()=>[(w(),P(Ge(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):Q("v-if",!0),e.showCheckbox?(w(),P(r,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:t[0]||(t[0]=I(()=>{},["stop"])),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onChange"])):Q("v-if",!0),e.node.loading?(w(),P(i,{key:2,class:O([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:q(()=>[T(c)]),_:1},8,["class"])):Q("v-if",!0),T(y,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),T(u,null,{default:q(()=>[!e.renderAfterExpand||e.childNodeRendered?ge((w(),B("div",{key:0,class:O(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(w(!0),B(Ke,null,Ee(e.node.childNodes,a=>(w(),P(p,{key:e.getNodeKey(a),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:a,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,kt)),[[ke,e.expanded]]):Q("v-if",!0)]),_:1})],42,gt)),[[ke,e.node.visible]])}var Ct=ie(yt,[["render",Nt],["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree-node.vue"]]);function vt({el$:e},t){const o=U("tree"),s=Ae([]),n=Ae([]);De(()=>{i()}),Ze(()=>{s.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),x(n,r=>{r.forEach(c=>{c.setAttribute("tabindex","-1")})}),et(e,"keydown",r=>{const c=r.target;if(!c.className.includes(o.b("node")))return;const y=r.code;s.value=Array.from(e.value.querySelectorAll(".".concat(o.is("focusable"),"[role=treeitem]")));const p=s.value.indexOf(c);let u;if([$.up,$.down].includes(y)){if(r.preventDefault(),y===$.up){u=p===-1?0:p!==0?p-1:s.value.length-1;const l=u;for(;!t.value.getNode(s.value[u].dataset.key).canFocus;){if(u--,u===l){u=-1;break}u<0&&(u=s.value.length-1)}}else{u=p===-1?0:p<s.value.length-1?p+1:0;const l=u;for(;!t.value.getNode(s.value[u].dataset.key).canFocus;){if(u++,u===l){u=-1;break}u>=s.value.length&&(u=0)}}u!==-1&&s.value[u].focus()}[$.left,$.right].includes(y)&&(r.preventDefault(),c.click());const a=c.querySelector('[type="checkbox"]');[$.enter,$.space].includes(y)&&a&&(r.preventDefault(),a.click())});const i=()=>{var r;s.value=Array.from(e.value.querySelectorAll(".".concat(o.is("focusable"),"[role=treeitem]"))),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const c=e.value.querySelectorAll(".".concat(o.is("checked"),"[role=treeitem]"));if(c.length){c[0].setAttribute("tabindex","0");return}(r=s.value[0])==null||r.setAttribute("tabindex","0")}}const mt=V({name:"ElTree",components:{ElTreeNode:Ct},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:tt}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:o}=nt(),s=U("tree"),n=D(new ut({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));n.value.initialize();const d=D(n.value.root),i=D(null),r=D(null),c=D(null),{broadcastExpanded:y}=Be(e),{dragState:p}=pt({props:e,ctx:t,el$:r,dropIndicator$:c,store:n});vt({el$:r},n);const u=L(()=>{const{childNodes:h}=d.value;return!h||h.length===0||h.every(({visible:N})=>!N)});x(()=>e.currentNodeKey,h=>{n.value.setCurrentNodeKey(h)}),x(()=>e.defaultCheckedKeys,h=>{n.value.setDefaultCheckedKey(h)}),x(()=>e.defaultExpandedKeys,h=>{n.value.setDefaultExpandedKeys(h)}),x(()=>e.data,h=>{n.value.setData(h)},{deep:!0}),x(()=>e.checkStrictly,h=>{n.value.checkStrictly=h});const a=h=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");n.value.filter(h)},l=h=>we(e.nodeKey,h.data),f=h=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const N=n.value.getNode(h);if(!N)return[];const F=[N.data];let W=N.parent;for(;W&&W!==d.value;)F.push(W.data),W=W.parent;return F.reverse()},k=(h,N)=>n.value.getCheckedNodes(h,N),C=h=>n.value.getCheckedKeys(h),m=()=>{const h=n.value.getCurrentNode();return h?h.data:null},b=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const h=m();return h?h[e.nodeKey]:null},S=(h,N)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");n.value.setCheckedNodes(h,N)},M=(h,N)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");n.value.setCheckedKeys(h,N)},v=(h,N,F)=>{n.value.setChecked(h,N,F)},X=()=>n.value.getHalfCheckedNodes(),Z=()=>n.value.getHalfCheckedKeys(),j=(h,N=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");Ne(n,t.emit,()=>n.value.setUserCurrentNode(h,N))},g=(h,N=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");Ne(n,t.emit,()=>n.value.setCurrentNodeKey(h,N))},K=h=>n.value.getNode(h),E=h=>{n.value.remove(h)},le=(h,N)=>{n.value.append(h,N)},Pe=(h,N)=>{n.value.insertBefore(h,N)},qe=(h,N)=>{n.value.insertAfter(h,N)},ze=(h,N,F)=>{y(N),t.emit("node-expand",h,N,F)},Ve=(h,N)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");n.value.updateChildren(h,N)};return J("RootTree",{ctx:t,props:e,store:n,root:d,currentNode:i,instance:be()}),J(rt,void 0),{ns:s,store:n,root:d,currentNode:i,dragState:p,el$:r,dropIndicator$:c,isEmpty:u,filter:a,getNodeKey:l,getNodePath:f,getCheckedNodes:k,getCheckedKeys:C,getCurrentNode:m,getCurrentKey:b,setCheckedNodes:S,setCheckedKeys:M,setChecked:v,getHalfCheckedNodes:X,getHalfCheckedKeys:Z,setCurrentNode:j,setCurrentKey:g,t:o,getNode:K,remove:E,append:le,insertBefore:Pe,insertAfter:qe,handleNodeExpand:ze,updateKeyChildren:Ve}}});function bt(e,t,o,s,n,d){const i=A("el-tree-node");return w(),B("div",{ref:"el$",class:O([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(w(!0),B(Ke,null,Ee(e.root.childNodes,r=>(w(),P(i,{key:e.getNodeKey(r),node:r,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(w(),B("div",{key:0,class:O(e.ns.e("empty-block"))},[ot(e.$slots,"empty",{},()=>{var r;return[re("span",{class:O(e.ns.e("empty-text"))},Me((r=e.emptyText)!=null?r:e.t("el.tree.emptyText")),3)]})],2)):Q("v-if",!0),ge(re("div",{ref:"dropIndicator$",class:O(e.ns.e("drop-indicator"))},null,2),[[ke,e.dragState.showDropIndicator]])],2)}var oe=ie(mt,[["render",bt],["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree.vue"]]);oe.install=e=>{e.component(oe.name,oe)};const ve=oe,Kt=(e,{attrs:t},{tree:o,key:s})=>{const n=U("tree-select"),d={...ae(Le(e),Object.keys(pe.props)),...t,valueKey:s,popperClass:L(()=>{const i=[n.e("popper")];return e.popperClass&&i.push(e.popperClass),i.join(" ")}),filterMethod:(i="")=>{e.filterMethod&&e.filterMethod(i),_(()=>{var r;(r=o.value)==null||r.filter(i)})},onVisibleChange:i=>{var r;(r=t.onVisibleChange)==null||r.call(t,i),e.filterable&&i&&d.filterMethod()}};return d},Et=V({extends:xe,setup(e,t){const o=xe.setup(e,t);delete o.selectOptionClick;const s=be().proxy;return _(()=>{o.select.cachedOptions.get(s.value)||o.select.onOptionCreate(s)}),o},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function me(e){return e||e===0}function Se(e){return Array.isArray(e)&&e.length}function Y(e){return Array.isArray(e)?e:me(e)?[e]:[]}function se(e,t,o,s,n){for(let d=0;d<e.length;d++){const i=e[d];if(t(i,d,e,n))return s?s(i,d,e,n):i;{const r=o(i);if(Se(r)){const c=se(r,t,o,s,i);if(c)return c}}}}function $e(e,t,o,s){for(let n=0;n<e.length;n++){const d=e[n];t(d,n,e,s);const i=o(d);Se(i)&&$e(i,t,o,d)}}const Dt=(e,{attrs:t,slots:o,emit:s},{select:n,tree:d,key:i})=>{x(()=>e.modelValue,()=>{e.showCheckbox&&_(()=>{const a=d.value;a&&!it(a.getCheckedKeys(),Y(e.modelValue))&&a.setCheckedKeys(Y(e.modelValue))})},{immediate:!0,deep:!0});const r=L(()=>({value:i.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),c=(a,l)=>{var f;const k=r.value[a];return Oe(k)?k(l,(f=d.value)==null?void 0:f.getNode(c("value",l))):l[k]},y=Y(e.modelValue).map(a=>se(e.data||[],l=>c("value",l)===a,l=>c("children",l),(l,f,k,C)=>C&&c("value",C))).filter(a=>me(a)),p=L(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const a=[];return $e(e.data.concat(e.cacheData),l=>{const f=c("value",l);a.push({value:f,currentLabel:c("label",l),isDisabled:c("disabled",l)})},l=>c("children",l)),a}),u=L(()=>p.value.reduce((a,l)=>({...a,[l.value]:l}),{}));return{...ae(Le(e),Object.keys(ve.props)),...t,nodeKey:i,expandOnClickNode:L(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:L(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(y):y),renderContent:(a,{node:l,data:f,store:k})=>a(Et,{value:c("value",f),label:c("label",f),disabled:c("disabled",f)},e.renderContent?()=>e.renderContent(a,{node:l,data:f,store:k}):o.default?()=>o.default({node:l,data:f,store:k}):void 0),filterNodeMethod:(a,l,f)=>{var k;return e.filterNodeMethod?e.filterNodeMethod(a,l,f):a?(k=c("label",l))==null?void 0:k.includes(a):!0},onNodeClick:(a,l,f)=>{var k,C,m;if((k=t.onNodeClick)==null||k.call(t,a,l,f),!(e.showCheckbox&&e.checkOnClickNode))if(!e.showCheckbox&&(e.checkStrictly||l.isLeaf)){if(!c("disabled",a)){const b=(C=n.value)==null?void 0:C.options.get(c("value",a));(m=n.value)==null||m.handleOptionSelect(b)}}else e.expandOnClickNode&&f.proxy.handleExpandIconClick()},onCheck:(a,l)=>{if(!e.showCheckbox)return;const f=c("value",a),k=l.checkedKeys,C=e.multiple?Y(e.modelValue).filter(b=>b in u.value&&!d.value.getNode(b)&&!k.includes(b)):[],m=k.concat(C);if(e.checkStrictly)s(fe,e.multiple?m:m.includes(f)?f:void 0);else if(e.multiple)s(fe,d.value.getCheckedKeys(!0));else{const b=se([a],v=>!Se(c("children",v))&&!c("disabled",v),v=>c("children",v)),S=b?c("value",b):void 0,M=me(e.modelValue)&&!!se([a],v=>c("value",v)===e.modelValue,v=>c("children",v));s(fe,S===e.modelValue||M?void 0:S)}_(()=>{var b;const S=Y(e.modelValue);d.value.setCheckedKeys(S),(b=t.onCheck)==null||b.call(t,a,{checkedKeys:d.value.getCheckedKeys(),checkedNodes:d.value.getCheckedNodes(),halfCheckedKeys:d.value.getHalfCheckedKeys(),halfCheckedNodes:d.value.getHalfCheckedNodes()})})},cacheOptions:p}};var wt=V({props:{data:{type:Array,default:()=>[]}},setup(e){const t=H(Fe);return x(()=>e.data,()=>{var o;e.data.forEach(n=>{t.cachedOptions.has(n.value)||t.cachedOptions.set(n.value,n)});const s=((o=t.selectWrapper)==null?void 0:o.querySelectorAll("input"))||[];Array.from(s).includes(document.activeElement)||t.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const St=V({name:"ElTreeSelect",inheritAttrs:!1,props:{...pe.props,...ve.props,cacheData:{type:Array,default:()=>[]}},setup(e,t){const{slots:o,expose:s}=t,n=D(),d=D(),i=L(()=>e.nodeKey||e.valueKey||"value"),r=Kt(e,t,{select:n,tree:d,key:i}),{cacheOptions:c,...y}=Dt(e,t,{select:n,tree:d,key:i}),p=te({});return s(p),De(()=>{Object.assign(p,{...ae(d.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...ae(n.value,["focus","blur"])})}),()=>G(pe,te({...r,ref:u=>n.value=u}),{...o,default:()=>[G(wt,{data:c.value}),G(ve,te({...y,ref:u=>d.value=u}))]})}});var de=ie(St,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-select/src/tree-select.vue"]]);de.install=e=>{e.component(de.name,de)};const xt=de,At=xt;const Ht=V({__name:"rolePermission",setup(e){const t=D(),o=D([]),s=D([]),n=D([]),d=()=>{ce.get("/8080/admin/permissions").then(r=>{const c=r.data.map(y=>({label:y.name,value:y.id,pid:y.pid,id:y.id}));s.value=c,n.value=dt.arrayToTree(c,0),n.value}),ce.get("/8080/admin/rolePermission").then(r=>{o.value=r.data})},i=({row:r,column:c})=>{const y=t.value;if(y){const p=c.field;if(r[p],y.isUpdateByRow(r,p)&&p==="permissionSet"){const u=r.permissionSet;ce.get("/8080/admin/role/permission",{pids:u,rid:r.id}).then(a=>{a.data.status=="success"&&(at["".concat(a.data.status)]("".concat(a.data.msg)),setTimeout(()=>{y.reloadRow(r,null,p)},300))});return}}};return De(()=>{d()}),(r,c)=>{const y=A("vxe-column"),p=lt,u=At,a=A("vxe-table");return w(),B("div",null,[re("div",null,[T(He,{refresh:d})]),T(a,{ref_key:"xTable",ref:t,border:"",data:he(o),stripe:"","column-config":{useKey:!0},"row-config":{useKey:!0},"keep-source":"","edit-config":{trigger:"dblclick",mode:"cell",showStatus:!0},onEditClosed:i},{default:q(()=>[T(y,{type:"seq",field:"id",width:"60"}),T(y,{field:"name",title:"角色名称"}),T(y,{field:"permissionSet",title:"权限名称&key","edit-render":{}},{default:q(({row:l})=>[(w(!0),B(Ke,null,Ee(l.permissionSet,f=>(w(),P(p,{key:f,type:"success",class:"ml-4"},{default:q(()=>[st(Me(he(s).filter(k=>k.value==f)[0].label),1)]),_:2},1024))),128))]),edit:q(({row:l})=>[T(u,{modelValue:l.permissionSet,"onUpdate:modelValue":f=>l.permissionSet=f,data:he(n),multiple:"","render-after-expand":!1,"show-checkbox":"","check-strictly":"","check-on-click-node":""},null,8,["modelValue","onUpdate:modelValue","data"])]),_:1})]),_:1},8,["data"])])}}});export{Ht as _};
