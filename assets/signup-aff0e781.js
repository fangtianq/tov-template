/* empty css             */import{E as U,a as B}from"./form-item-6a1a9d26.js";import"./popper-490b1252.js";import{E as M}from"./popover-a8efa7e1.js";import{E as T}from"./button-bfcc4e4a.js";import{o as w,a as V,b as i,d as L,g as b,e as g,H as R,s as j,r as z,w as t,x as l,y as o,n as h,A as u,B as A,O as D,aM as H,cT as O,a3 as c,cU as q}from"./index-01622320.js";/* empty css              */import{_ as G}from"./logo-23e8bad3.js";import{a as J}from"./index-d2c44701.js";import{E as K}from"./index-38142232.js";import{b as v}from"./route-block-83d24a4e.js";import"./constants-6e2a2e6f.js";import"./use-form-item-e55812c6.js";import"./event-1da57d2d.js";import"./index-414d99d5.js";import"./_baseClone-2e2f2132.js";import"./_Uint8Array-ad24a697.js";import"./_initCloneObject-ae9ac112.js";import"./_getTag-79868909.js";import"./isNil-c75b1b34.js";import"./focus-trap-48b16445.js";import"./dropdown-b55d16ec.js";import"./index-cae2b4ed.js";import"./index-86a38320.js";import"./favicon-d22aecf5.js";const Q={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},W=i("path",{fill:"currentColor",d:"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59z"},null,-1),X=[W];function Y(k,e){return w(),V("svg",Q,[...X])}const Z={name:"mdi-check",render:Y},ee={class:"h-screen font-github"},se={class:"flex justify-center items-center flex-col"},oe=i("div",{class:"font-300 text-2xl tracking-github mb-4"}," Sign up to tov-template ",-1),te={class:"w-77 bg-github_bg dark:bg-github_bg_dark border-github_b rounded-xl border-1 p-4"},ae={class:"w-max h-max cursor-pointer"},ne=["src"],re={class:"mt-3 w-77 bg-white border-github_b rounded-xl border-1 p-4"},le={class:"text-github_a"},ie=L({__name:"signup",setup(k){J.get("api/article/all").then(n=>{});const e=b({username:"",password:"",checkPass:"",nickName:"",smsCodeInput:"",smsCode:"",smsCodeVisible:!1,smsCodeCanSend:!1,smsCodeTip:"刷新验证码",captcha:g()}),_=n=>{e.smsCodeVisible=n},S=()=>{_(!0),e.smsCodeCanSend=!1,O().then(n=>{e.smsCode=n.url,e.captcha=n})},f=R.debounce(S,1e3,{leading:!0,trailing:!1}),x=j(),P=()=>{var n;e.smsCodeInput==""||e.smsCodeInput.length!=4||(n=e.captcha)==null||n.verify(e.smsCodeInput).then(s=>{_(!1),e.smsCodeCanSend=!0,e.smsCodeVisible=!1},s=>{s.code=="800"?f():c.error(s.rawMessage)}).catch(s=>{c.error(s)})},E=b({password:[{validator:(n,s,a)=>{if(s==="")a(new Error("Please input the password"));else{if(e.checkPass!==""){if(!p.value)return;p.value.validateField("checkPass",()=>null)}a()}},trigger:"blur"}],checkPass:[{validator:(n,s,a)=>{s===""?a(new Error("Please input the password again")):s!==e.password?a(new Error("Two inputs don't match!")):a()},trigger:"blur"}],smsCodeInput:[{validator:(n,s,a)=>{e.smsCodeCanSend?a():a(new Error("SmsCode don't match!"))},trigger:"blur"}]}),p=g(),y=n=>{n&&n.validate(s=>{if(s)q()(e.username,e.password).then(a=>{c.success("注册成功"),x.push("login"),"注册成功。objectId：".concat(a.id)},a=>{c.error("注册失败：".concat(a.rawMessage||a.response.data))});else return!1})};return(n,s)=>{const a=G,m=K,d=U,I=Z,C=T,$=M,F=z("router-link"),N=B;return w(),V("div",ee,[t(N,{ref_key:"ruleFormRef",ref:p,model:o(e),"label-position":"top",rules:o(E)},{default:l(()=>[i("div",se,[t(a),oe,i("div",te,[t(d,{label:"Phone number"},{default:l(()=>[t(m,{modelValue:o(e).username,"onUpdate:modelValue":s[0]||(s[0]=r=>o(e).username=r)},null,8,["modelValue"])]),_:1}),t(d,{label:"Password",prop:"password"},{default:l(()=>[t(m,{modelValue:o(e).password,"onUpdate:modelValue":s[1]||(s[1]=r=>o(e).password=r),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(d,{label:"Confirm",prop:"checkPass"},{default:l(()=>[t(m,{modelValue:o(e).checkPass,"onUpdate:modelValue":s[2]||(s[2]=r=>o(e).checkPass=r),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(d,{label:"nickName"},{default:l(()=>[t(m,{modelValue:o(e).nickName,"onUpdate:modelValue":s[3]||(s[3]=r=>o(e).nickName=r)},null,8,["modelValue"])]),_:1}),t(d,{prop:"smsCodeInput"},{default:l(()=>[t($,{visible:o(e).smsCodeVisible,placement:"top"},{reference:l(()=>[t(C,{id:"verify",class:h("text-github_a mb-1"),disabled:o(e).smsCodeCanSend,onClick:o(f)},{default:l(()=>[i("span",{class:h(o(e).smsCodeCanSend?"text-green-500":"")},[u(A(o(e).smsCodeTip)+" ",1),D(t(I,null,null,512),[[H,o(e).smsCodeCanSend]])],2)]),_:1},8,["disabled","onClick"])]),default:l(()=>[i("div",ae,[i("img",{src:o(e).smsCode},null,8,ne)])]),_:1},8,["visible"]),t(m,{modelValue:o(e).smsCodeInput,"onUpdate:modelValue":s[4]||(s[4]=r=>o(e).smsCodeInput=r),modelModifiers:{trim:!0},class:"w-8",disabled:!o(e).smsCodeVisible,onFocus:s[5]||(s[5]=r=>_(!0)),onInput:s[6]||(s[6]=r=>P())},null,8,["modelValue","disabled"])]),_:1}),t(d,null,{default:l(()=>[t(C,{class:"w-full rounded-2xl shadow-github_button",color:"#2da44e",type:"primary",onClick:s[7]||(s[7]=r=>y(o(p)))},{default:l(()=>[u("Sign up")]),_:1})]),_:1})]),i("div",re,[u(" Already have an account? "),i("a",le,[t(F,{to:"login"},{default:l(()=>[u(" Sign in → ")]),_:1})]),u(" . ")])])]),_:1},8,["model","rules"])])}}});typeof v=="function"&&v(ie);export{ie as default};
