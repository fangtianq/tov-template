import{a as $}from"./index.c7404254.js";import{h as w,a as k,b as i,d as U,ak as h,m as b,am as M,f as t,w as l,e as o,by as T,Q as g,i as m,t as L,p as A,a8 as D,n as R,aq as c,bz as z,r as j}from"./index.e2680d94.js";/* empty css             */import{E as q,a as Q,_ as Z}from"./logo.c7c82ed2.js";import"./popper.da03fc45.js";import{E as G}from"./popover.41bc3bd7.js";import{E as H}from"./button.63c284dd.js";import{E as J}from"./input.6cc53ceb.js";import{b as v}from"./route-block.6a611cbf.js";import"./error.7e8331f1.js";import"./index.1f13e4e9.js";import"./favicon.eb9475ba.js";import"./isNil.98bb3b88.js";import"./index.328335d4.js";import"./index.2331036c.js";import"./index.8bfffa1c.js";import"./event.776e7e11.js";const K={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},O=i("path",{fill:"currentColor",d:"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59L21 7Z"},null,-1),W=[O];function X(V,e){return w(),k("svg",K,W)}const Y={name:"mdi-check",render:X},ee={class:"h-screen font-github"},se={class:"flex justify-center items-center flex-col"},oe=i("div",{class:"font-300 text-2xl tracking-github mb-4"}," Sign up to tov-template ",-1),te={class:"w-77 bg-github_bg dark:bg-github_bg_dark border-github_b rounded-xl border-1 p-4"},ae={class:"w-max h-max cursor-pointer"},ne=["src"],re={class:"mt-3 w-77 bg-white border-github_b rounded-xl border-1 p-4"},le={class:"text-github_a"},ie=U({__name:"signup",setup(V){$.get("api/article/all").then(a=>{});const e=h({username:"",password:"",checkPass:"",nickName:"",smsCodeInput:"",smsCode:"",smsCodeVisible:!1,smsCodeCanSend:!1,smsCodeTip:"\u5237\u65B0\u9A8C\u8BC1\u7801",captcha:b()}),_=a=>{e.smsCodeVisible=a},S=()=>{_(!0),e.smsCodeCanSend=!1,T().then(a=>{e.smsCode=a.url,e.captcha=a})},f=M.debounce(S,1e3,{leading:!0,trailing:!1}),x=R(),E=()=>{var a;e.smsCodeInput==""||e.smsCodeInput.length!=4||(a=e.captcha)==null||a.verify(e.smsCodeInput).then(s=>{_(!1),e.smsCodeCanSend=!0,e.smsCodeVisible=!1},s=>{s.code=="800"?f():c.error(s.rawMessage)}).catch(s=>{c.error(s)})},P=h({password:[{validator:(a,s,n)=>{if(s==="")n(new Error("Please input the password"));else{if(e.checkPass!==""){if(!p.value)return;p.value.validateField("checkPass",()=>null)}n()}},trigger:"blur"}],checkPass:[{validator:(a,s,n)=>{s===""?n(new Error("Please input the password again")):s!==e.password?n(new Error("Two inputs don't match!")):n()},trigger:"blur"}],smsCodeInput:[{validator:(a,s,n)=>{e.smsCodeCanSend?n():n(new Error("SmsCode don't match!"))},trigger:"blur"}]}),p=b(),y=a=>{!a||a.validate(s=>{if(s)z()(e.username,e.password).then(n=>{c.success("\u6CE8\u518C\u6210\u529F"),x.push("login")},n=>{c.error(`\u6CE8\u518C\u5931\u8D25\uFF1A${n.rawMessage}`)});else return!1})};return(a,s)=>{const n=Z,u=J,d=q,I=Y,C=H,F=G,B=j("router-link"),N=Q;return w(),k("div",ee,[t(N,{ref_key:"ruleFormRef",ref:p,model:o(e),"label-position":"top",rules:o(P)},{default:l(()=>[i("div",se,[t(n),oe,i("div",te,[t(d,{label:"Phone number"},{default:l(()=>[t(u,{modelValue:o(e).username,"onUpdate:modelValue":s[0]||(s[0]=r=>o(e).username=r)},null,8,["modelValue"])]),_:1}),t(d,{label:"Password",prop:"password"},{default:l(()=>[t(u,{modelValue:o(e).password,"onUpdate:modelValue":s[1]||(s[1]=r=>o(e).password=r),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(d,{label:"Confirm",prop:"checkPass"},{default:l(()=>[t(u,{modelValue:o(e).checkPass,"onUpdate:modelValue":s[2]||(s[2]=r=>o(e).checkPass=r),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(d,{label:"nickName"},{default:l(()=>[t(u,{modelValue:o(e).nickName,"onUpdate:modelValue":s[3]||(s[3]=r=>o(e).nickName=r)},null,8,["modelValue"])]),_:1}),t(d,{prop:"smsCodeInput"},{default:l(()=>[t(F,{visible:o(e).smsCodeVisible,placement:"top"},{reference:l(()=>[t(C,{id:"verify",class:g("text-github_a mb-1"),onClick:o(f)},{default:l(()=>[i("span",{class:g(o(e).smsCodeCanSend?"text-green-500":"")},[m(L(o(e).smsCodeTip)+" ",1),A(t(I,null,null,512),[[D,o(e).smsCodeCanSend]])],2)]),_:1},8,["onClick"])]),default:l(()=>[i("div",ae,[i("img",{src:o(e).smsCode},null,8,ne)])]),_:1},8,["visible"]),t(u,{modelValue:o(e).smsCodeInput,"onUpdate:modelValue":s[4]||(s[4]=r=>o(e).smsCodeInput=r),modelModifiers:{trim:!0},class:"w-8",disabled:!o(e).smsCodeVisible,onFocus:s[5]||(s[5]=r=>_(!0)),onInput:s[6]||(s[6]=r=>E())},null,8,["modelValue","disabled"])]),_:1}),t(d,null,{default:l(()=>[t(C,{class:"w-full rounded-2xl shadow-github_button",color:"#2da44e",type:"primary",onClick:s[7]||(s[7]=r=>y(o(p)))},{default:l(()=>[m("Sign up")]),_:1})]),_:1})]),i("div",re,[m(" Already have an account? "),i("a",le,[t(B,{to:"login"},{default:l(()=>[m(" Sign in \u2192 ")]),_:1})]),m(" . ")])])]),_:1},8,["model","rules"])])}}});typeof v=="function"&&v(ie);export{ie as default};
