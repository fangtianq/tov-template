import{a as I}from"./index.f03dc688.js";import{d as E,z as _,l as b,_ as F,e as N,i as t,w as n,R as U,r as i,j as T,f as r,S as h,h as B,k as p,t as M,n as R,T as $,m as A,E as m,U as D}from"./index.1f85ee33.js";import{_ as j}from"./favicon.eb9475ba.js";import{b as v}from"./route-block.6a611cbf.js";const z={class:"bg-white h-screen font-github"},q={class:"flex justify-center items-center flex-col"},G=r("div",{class:"p-8"},[r("img",{src:j,class:"w-12 h-12",alt:"tov"})],-1),H=r("div",{class:"font-300 text-2xl tracking-github mb-4"}," Sign up to tov-template ",-1),J={class:"h-98 w-77 bg-github_bg border-github_b rounded-xl border-1 p-4"},K={class:"w-max h-max cursor-pointer"},L=["src"],O=r("div",{class:"mt-3 w-77 bg-white border-github_b rounded-xl border-1 p-4"},[p(" Already have an account? "),r("a",{href:"login",class:"text-github_a"}," Sign in \u2192 "),p(" . ")],-1),Q=E({__name:"signup",setup(W){I.get("api/article/all").then(a=>{});const e=_({username:"",password:"",checkPass:"",nickName:"",smsCodeInput:"",smsCode:"",smsCodeVisible:!1,smsCodeCanSend:!1,smsCodeTip:"\u5237\u65B0\u9A8C\u8BC1\u7801",captcha:b()}),c=a=>{e.smsCodeVisible=a},g=()=>{c(!0),e.smsCodeCanSend=!1,U().then(a=>{e.smsCode=a.url,e.captcha=a})},f=F.debounce(g,1e3,{leading:!0,trailing:!1}),w=A(),V=()=>{var a;e.smsCodeInput==""||e.smsCodeInput.length!=4||(a=e.captcha)==null||a.verify(e.smsCodeInput).then(s=>{c(!1),e.smsCodeCanSend=!0,e.smsCodeVisible=!1},s=>{s.code=="800"?f():m.error(s.rawMessage)}).catch(s=>{m.error(s)})},S=_({password:[{validator:(a,s,o)=>{if(s==="")o(new Error("Please input the password"));else{if(e.checkPass!==""){if(!u.value)return;u.value.validateField("checkPass",()=>null)}o()}},trigger:"blur"}],checkPass:[{validator:(a,s,o)=>{s===""?o(new Error("Please input the password again")):s!==e.password?o(new Error("Two inputs don't match!")):o()},trigger:"blur"}],smsCodeInput:[{validator:(a,s,o)=>{e.smsCodeCanSend?o():o(new Error("SmsCode don't match!"))},trigger:"blur"}]}),u=b(),k=a=>{!a||a.validate(s=>{if(s)D()(e.username,e.password).then(o=>{m.success("\u6CE8\u518C\u6210\u529F"),w.push("login")},o=>{m.error(`\u6CE8\u518C\u5931\u8D25\uFF1A${o.rawMessage}`)});else return!1})};return(a,s)=>{const o=i("el-input"),d=i("el-form-item"),x=i("i-mdi:check"),C=i("el-button"),P=i("el-popover"),y=i("el-form");return T(),N("div",z,[t(y,{ref_key:"ruleFormRef",ref:u,model:e,"label-position":"top",rules:S},{default:n(()=>[r("div",q,[G,H,r("div",J,[t(d,{label:"Phone number"},{default:n(()=>[t(o,{modelValue:e.username,"onUpdate:modelValue":s[0]||(s[0]=l=>e.username=l)},null,8,["modelValue"])]),_:1}),t(d,{label:"Password",prop:"password"},{default:n(()=>[t(o,{modelValue:e.password,"onUpdate:modelValue":s[1]||(s[1]=l=>e.password=l),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(d,{label:"Confirm",prop:"checkPass"},{default:n(()=>[t(o,{modelValue:e.checkPass,"onUpdate:modelValue":s[2]||(s[2]=l=>e.checkPass=l),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(d,{label:"nickName"},{default:n(()=>[t(o,{modelValue:e.nickName,"onUpdate:modelValue":s[3]||(s[3]=l=>e.nickName=l)},null,8,["modelValue"])]),_:1}),t(d,{prop:"smsCodeInput"},{default:n(()=>[t(P,{visible:e.smsCodeVisible,placement:"top"},{reference:n(()=>[t(C,{id:"verify",class:h("text-github_a mb-1"),onClick:B(f)},{default:n(()=>[r("span",{class:h(e.smsCodeCanSend?"text-green-500":"")},[p(M(e.smsCodeTip)+" ",1),R(t(x,null,null,512),[[$,e.smsCodeCanSend]])],2)]),_:1},8,["onClick"])]),default:n(()=>[r("div",K,[r("img",{src:e.smsCode},null,8,L)])]),_:1},8,["visible"]),t(o,{modelValue:e.smsCodeInput,"onUpdate:modelValue":s[4]||(s[4]=l=>e.smsCodeInput=l),modelModifiers:{trim:!0},class:"w-8",disabled:!e.smsCodeVisible,onFocus:s[5]||(s[5]=l=>c(!0)),onInput:s[6]||(s[6]=l=>V())},null,8,["modelValue","disabled"])]),_:1}),t(d,null,{default:n(()=>[t(C,{class:"w-full rounded-2xl shadow-github_button",color:"#2da44e",type:"primary",onClick:s[7]||(s[7]=l=>k(u.value))},{default:n(()=>[p("Sign up")]),_:1})]),_:1})]),O])]),_:1},8,["model","rules"])])}}});typeof v=="function"&&v(Q);export{Q as default};
