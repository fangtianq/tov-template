System.register(["./base-legacy.38854648.js","./button-legacy.1437b25c.js","./delete-legacy.d30ca299.js","./input-legacy.13394860.js","./index-legacy.e18a26ca.js","./request-legacy.e4cdfa86.js","./index-legacy.f062f27b.js"],(function(e,t){"use strict";var a,s,l,n,c,o,r,u,i,d,b,v,p,j,y,O,g,m,k,f,I,N,S,w,_,h;return{setters:[null,e=>{a=e.E},e=>{s=e._},null,e=>{l=e.g,n=e.h,c=e.av,o=e.j,r=e.K,u=e.l,i=e.aV,d=e.o,b=e.z,v=e.p,p=e.F,j=e.aq,y=e.s,O=e.A,g=e.w,m=e.a9,k=e.c1,f=e.c2,I=e.b4,N=e.b5,S=e.aA,w=e.aa},e=>{_=e.a},e=>{h=e.E}],execute:function(){var t={class:"main p-4"},x={class:"message-container"},J=v("h3",null,"后台：org.sang.socket.livequery.LiveQueryController",-1),T=v("h3",null,"https://github.com/fangtianq/FTQPriSpringbootVueBlog",-1),C={class:"mdui-card-primary"},D={class:"mdui-card-content message-content inline-block"},V={class:"inline-block"},q=l({__name:"liveQuery",setup(e){var l,q,z=n(c.REFDANMU),A={Authorization:"",ContentType:"text/LCObject"},E=null,F=o([]),M=()=>{E&&(i.success("websocket重新连接成功..."),clearInterval(E),E=null),q=new k("/websocket"),(l=f.over(q)).connect(A,(()=>{i.success("websocket连接成功..."),l.subscribe("/create",(e=>{F.value.push(JSON.parse(e.body))})),l.subscribe("/delete",(e=>{var t=JSON.parse(e.body).objectId;F.value=F.value.filter((e=>e.objectId!=t))})),l.subscribe("/update",(e=>{var t=JSON.parse(e.body).objectId,a=F.value.findIndex((e=>e.objectId==t));F.value[a]=JSON.parse(e.body),z.value.insert(JSON.parse(e.body).object)}))}),(e=>{E=setInterval((()=>{M()}),5e3),i.error("websocket断线重连中...")})),_.post("/find",{className:I.TODO.name}).then((e=>{F.value=e.data.list}))};r((()=>{M()})),u((()=>{l.disconnect((()=>{q.onclose,q.close(),i.success("websocket断开成功！")}))}));var Q=()=>{var e=new(N.Object.extend(I.TODO.name));e.set(I.TODO.keys.content,"Hello world!"),e.set(I.TODO.keys.done,!0),e.set(I.TODO.keys.user,S()());var t=JSON.stringify({object:e.attributes,className:e.className});l.send("/app/saveInBackground",A,t)};return(e,n)=>{var c=h,o=s,r=a;return d(),b("div",t,[v("div",x,[J,T,(d(!0),b(p,null,j(y(F),(e=>(d(),b("div",{key:e.objectId,class:"mdui-card",style:{margin:"10px 0",width:"500px"}},[v("div",C,[v("div",D,[m(w(e.object.user.username+"："),1),O(c,{modelValue:e.object.content,"onUpdate:modelValue":t=>e.object.content=t,clearable:"",onInput:t=>{return a=e.objectId,s=e.object,void l.send("/app/updateObject",A,JSON.stringify({objectId:a,object:s}));var a,s}},null,8,["modelValue","onUpdate:modelValue","onInput"])]),v("div",V,[O(o,{class:"relative top-1",onClick:t=>{return a=e.objectId,void l.send("/app/deleteObject",A,JSON.stringify({objectId:a}));var a}},null,8,["onClick"])])])])))),128)),O(r,{type:"primary",size:"default",onClick:Q},{default:g((()=>[m("发送")])),_:1})])])}}}),z=Object.freeze(Object.defineProperty({__proto__:null,default:q},Symbol.toStringTag,{value:"Module"}));e("_",z)}}}));
