/* empty css             */import{E as $,a as q,b as J}from"./main-f71d9296.js";import{E as U}from"./button-89b799c3.js";/* empty css              */import{d as z,n as R,s as A,x as P,r as T,o as h,c as v,w as l,a3 as n,a4 as r,a5 as Q,S as B,a8 as S,Q as f,bd as H,au as y}from"./index-17a45ce3.js";import{a as b}from"./request-8ed27ecb.js";import{E}from"./el-overlay-0347a7ae.js";import{E as F}from"./index-142fdb78.js";import{_ as K}from"./Space-1eda4b35.js";const W=f("span",null,"保存",-1),X=f("span",null,"取消",-1),Y=f("span",null,"修改",-1),Z=f("span",null,"删除",-1),ee=f("span",null,"停止",-1),te=f("span",null,"恢复",-1),ne=z({__name:"quartz定时任务",setup(oe){const u=H;let g=R(""),p=A({jobClassNameList:[],jobList:[],data:[]}),c=R();const G=e=>{E.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t={jobName:e.jobName,jobGroup:e.jobGroup};b.post("/job/remove",t).then(()=>{m()})}).catch(()=>{})};function L(e){E.confirm("确定要停止吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t={jobName:e.jobName,jobGroup:e.jobGroup};b.post("/job/pause",t).then(()=>{m()})}).catch(()=>{})}function w(e){E.confirm("确定要恢复吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t={jobName:e.jobName,jobGroup:e.jobGroup};b.post("/job/resume",t).then(()=>{m()})}).catch(()=>{})}function m(){let e={jobName:g.value};b.post("/job/list",e).then(t=>{p.jobList=[],t.data.content.forEach(s=>{s.editing=!1,p.jobList.push(s),s.triggerState.toLowerCase()=="waiting"&&setTimeout(()=>{m()},1e3)})})}async function D(e){var _,x,C;if(p.jobList.filter(N=>N.editing).length){y.info({showClose:!0,message:"正在编辑中"});return}if((((_=c.value)==null?void 0:_.getInsertRecords())||[]).length>0){y.info({showClose:!0,message:"正在新增中"});return}let d={cronExpression:"0/20 * * * * ?",jobClassName:"org.sang.plugins.quartz.job.ChickenJob",jobDescription:"测试任务",jobGroup:"test",jobName:"test01111",schedName:"ClusteredScheduler",triggerGroup:"同jobGroup",triggerName:"trigger+jobName",triggerState:"ACQUIRED"},{row:o}=await((x=c.value)==null?void 0:x.insertAt(d,e))||{row:""};await((C=c.value)==null?void 0:C.setEditCell(o,"cronExpression"))}const M=e=>{var s;if(p.jobList.filter(a=>a.editing).length){y.info({showClose:!0,message:"正在编辑中"});return}e.editing=!0,(s=c.value)==null||s.setEditRow(e)},O=e=>{var a,d;let t=c,s=((a=t.value)==null?void 0:a.getInsertRecords())||[];(d=t.value)==null||d.clearEdit().then(()=>{var o,_;(o=t.value)==null||o.revertData(e),e.editing=!1,s.length>0&&((_=t.value)==null||_.revertData())})},V=e=>{var t;(t=c.value)==null||t.clearEdit().then(()=>{E.confirm("确定要修改吗吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var d;if((((d=c.value)==null?void 0:d.getInsertRecords())||[]).length>0){let o={cronExpression:e.cronExpression,jobClassName:e.jobClassName,jobDescription:e.jobDescription,jobGroup:e.jobGroup,jobName:e.jobName};b.post("/job/add",o).then(()=>{m()})}else{let o={triggerName:e.triggerName,triggerGroup:e.triggerGroup,cronExpression:e.cronExpression};b.post("/job/modifyJob",o).then(()=>{m()})}}).catch(s=>{})})},I=({row:e},t)=>{e.jobClassName=t.target.value};return P(()=>{m(),b.get("/job/getJobClassList",{}).then(e=>{e.data.content.forEach(t=>{p.jobClassNameList.push({label:t,value:t,disabled:!1})})})}),(e,t)=>{const s=F,a=U,d=$,o=T("vxe-column"),_=K,x=T("vxe-table"),C=q,N=J;return h(),v(N,null,{default:l(()=>[n(d,{class:"cate_mana_header inline-block"},{default:l(()=>[n(s,{modelValue:r(g),"onUpdate:modelValue":t[0]||(t[0]=i=>Q(g)?g.value=i:g=i),placeholder:"请输入job名称",style:{width:"200px"}},null,8,["modelValue"]),n(a,{type:"primary",icon:r(u).textBoxSearch,style:{"margin-left":"10px"},onClick:m},{default:l(()=>[B("搜索任务")]),_:1},8,["icon"]),n(a,{type:"primary",icon:r(u).textBoxPlus,style:{"margin-left":"10px"},onClick:t[1]||(t[1]=i=>D())},{default:l(()=>[B("新增任务")]),_:1},8,["icon"])]),_:1}),n(C,{class:"cate_mana_main"},{default:l(()=>[n(x,{ref_key:"editable",ref:c,data:r(p).jobList,"onUpdate:data":t[2]||(t[2]=i=>r(p).jobList=i),"edit-config":{trigger:"manual",mode:"row",autoClear:!1,showStatus:!0,icon:"fa fa-pencil-square-o"}},{default:l(()=>[n(o,{type:"checkbox",width:"55"}),n(o,{type:"seq",width:"55"}),n(o,{field:"schedName",title:"clusteredScheduler名称",width:"200"}),n(o,{field:"jobName",title:"任务名称","edit-render":{name:"input"}}),n(o,{field:"jobGroup",title:"任务分组","edit-render":{name:"input"}}),n(o,{field:"jobDescription",title:"描述","edit-render":{name:"input"}}),n(o,{field:"jobClassName",title:"执行类",width:"300","edit-render":{name:"select",options:r(p).jobClassNameList,events:{change:I}}},null,8,["edit-render"]),n(o,{field:"cronExpression",title:"执行时间","edit-render":{name:"input"}}),n(o,{field:"triggerName",title:"触发器名称",width:"130"}),n(o,{field:"triggerGroup",title:"触发器分组"}),n(o,{field:"triggerDescription",title:"触发器描述"}),n(o,{field:"triggerState",title:"触发器状态"}),n(o,{title:"操作",width:"300",align:"center"},{default:l(({row:i})=>{var k;return[(k=r(c))!=null&&k.isEditByRow(i)?(h(),v(_,{key:0},{default:l(()=>[n(a,{icon:r(u).contentSave,onClick:j=>V(i)},{default:l(()=>[W]),_:2},1032,["icon","onClick"]),n(a,{icon:r(u).cancel,onClick:j=>O(i)},{default:l(()=>[X]),_:2},1032,["icon","onClick"])]),_:2},1024)):(h(),v(_,{key:1},{default:l(()=>[n(a,{icon:r(u).contentSaveEdit,onClick:j=>M(i)},{default:l(()=>[Y]),_:2},1032,["icon","onClick"]),n(a,{type:"danger",icon:r(u).contentSaveOff,onClick:j=>G(i)},{default:l(()=>[Z]),_:2},1032,["icon","onClick"]),i.triggerState=="ACQUIRED"?(h(),v(a,{key:0,icon:r(u).stop,onClick:j=>L(i)},{default:l(()=>[ee]),_:2},1032,["icon","onClick"])):S("",!0),i.triggerState=="PAUSED"?(h(),v(a,{key:1,icon:r(u).play,onClick:j=>w(i)},{default:l(()=>[te]),_:2},1032,["icon","onClick"])):S("",!0)]),_:2},1024))]}),_:1})]),_:1},8,["data"])]),_:1})]),_:1})}}});const me=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"}));export{me as _};
