import{b as Q,f as K,a as Pe}from"./constants-6e2a2e6f.js";import{bN as Ve,aF as Z,bE as fe,aO as Y,b9 as $e,aK as X,aY as ve,e as L,f as v,d as N,aA as ee,Y as $,p as me,g as pe,bh as he,o as H,a as be,j as V,n as O,y as d,az as ge,aW as ye,X as R,h as _e,i as Se,bt as Re,aR as ze,w as z,F as je,m as Fe,bB as qe,cf as Te,bs as ae,cg as D,x as G,c as ke,U as Ue,G as se,A as De,B as ne,E as ie,b as ue,c8 as Ge,aT as Ke,aU as Ye}from"./index-01622320.js";import{a as We}from"./use-form-item-e55812c6.js";import{d as Xe,t as He}from"./event-1da57d2d.js";import{S as Je}from"./index-414d99d5.js";import{b as Qe}from"./_baseClone-2e2f2132.js";function J(){if(!arguments.length)return[];var a=arguments[0];return Ve(a)?a:[a]}var Ze=4;function de(a){return Qe(a,Ze)}const et=Z({size:{type:String,values:fe},disabled:Boolean}),tt=Z({...et,model:Object,rules:{type:Y(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),rt={validate:(a,p,e)=>($e(a)||X(a))&&ve(p)&&X(e)};function lt(){const a=L([]),p=v(()=>{if(!a.value.length)return"0";const u=Math.max(...a.value);return u?"".concat(u,"px"):""});function e(u){const i=a.value.indexOf(u);return i===-1&&p.value,i}function c(u,i){if(u&&i){const f=e(i);a.value.splice(f,1,u)}else u&&a.value.push(u)}function t(u){const i=e(u);i>-1&&a.value.splice(i,1)}return{autoLabelWidth:p,registerLabelWidth:c,deregisterLabelWidth:t}}const P=(a,p)=>{const e=J(p);return e.length>0?a.filter(c=>c.prop&&e.includes(c.prop)):a},ot="ElForm",at=N({name:ot}),st=N({...at,props:tt,emits:rt,setup(a,{expose:p,emit:e}){const c=a,t=[],u=We(),i=ee("form"),f=v(()=>{const{labelPosition:o,inline:n}=c;return[i.b(),i.m(u.value||"default"),{[i.m("label-".concat(o))]:o,[i.m("inline")]:n}]}),E=o=>{t.push(o)},g=o=>{o.prop&&t.splice(t.indexOf(o),1)},s=(o=[])=>{c.model&&P(t,o).forEach(n=>n.resetField())},b=(o=[])=>{P(t,o).forEach(n=>n.clearValidate())},y=v(()=>!!c.model),C=o=>{if(t.length===0)return[];const n=P(t,o);return n.length?n:[]},x=async o=>w(void 0,o),W=async(o=[])=>{if(!y.value)return!1;const n=C(o);if(n.length===0)return!0;let _={};for(const S of n)try{await S.validate("")}catch(I){_={..._,...I}}return Object.keys(_).length===0?!0:Promise.reject(_)},w=async(o=[],n)=>{const _=!ye(n);try{const S=await W(o);return S===!0&&(n==null||n(S)),S}catch(S){if(S instanceof Error)throw S;const I=S;return c.scrollToError&&B(Object.keys(I)[0]),n==null||n(!1,I),_&&Promise.reject(I)}},B=o=>{var n;const _=P(t,o)[0];_&&((n=_.$el)==null||n.scrollIntoView(c.scrollIntoViewOptions))};return $(()=>c.rules,()=>{c.validateOnRuleChange&&x().catch(o=>Xe())},{deep:!0}),me(Q,pe({...he(c),emit:e,resetFields:s,clearValidate:b,validateField:w,addField:E,removeField:g,...lt()})),p({validate:x,validateField:w,resetFields:s,clearValidate:b,scrollToField:B}),(o,n)=>(H(),be("form",{class:O(d(f))},[V(o.$slots,"default")],2))}});var nt=ge(st,[["__file","form.vue"]]);const it=["","error","validating","success"],ut=Z({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:Y([String,Array])},required:{type:Boolean,default:void 0},rules:{type:Y([Object,Array])},error:String,validateStatus:{type:String,values:it},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:fe}}),ce="ElLabelWrap";var dt=N({name:ce,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(a,{slots:p}){const e=R(Q,void 0),c=R(K);c||He(ce,"usage: <el-form-item><label-wrap /></el-form-item>");const t=ee("form"),u=L(),i=L(0),f=()=>{var s;if((s=u.value)!=null&&s.firstElementChild){const b=window.getComputedStyle(u.value.firstElementChild).width;return Math.ceil(Number.parseFloat(b))}else return 0},E=(s="update")=>{Fe(()=>{p.default&&a.isAutoWidth&&(s==="update"?i.value=f():s==="remove"&&(e==null||e.deregisterLabelWidth(i.value)))})},g=()=>E("update");return _e(()=>{g()}),Se(()=>{E("remove")}),Re(()=>g()),$(i,(s,b)=>{a.updateAll&&(e==null||e.registerLabelWidth(s,b))}),ze(v(()=>{var s,b;return(b=(s=u.value)==null?void 0:s.firstElementChild)!=null?b:null}),g),()=>{var s,b;if(!p)return null;const{isAutoWidth:y}=a;if(y){const C=e==null?void 0:e.autoLabelWidth,x=c==null?void 0:c.hasLabel,W={};if(x&&C&&C!=="auto"){const w=Math.max(0,Number.parseInt(C,10)-i.value),B=e.labelPosition==="left"?"marginRight":"marginLeft";w&&(W[B]="".concat(w,"px"))}return z("div",{ref:u,class:[t.be("item","label-wrap")],style:W},[(s=p.default)==null?void 0:s.call(p)])}else return z(je,{ref:u},[(b=p.default)==null?void 0:b.call(p)])}}});const ct=["role","aria-labelledby"],ft=N({name:"ElFormItem"}),vt=N({...ft,props:ut,setup(a,{expose:p}){const e=a,c=qe(),t=R(Q,void 0),u=R(K,void 0),i=We(void 0,{formItem:!1}),f=ee("form-item"),E=Pe().value,g=L([]),s=L(""),b=Te(s,100),y=L(""),C=L();let x,W=!1;const w=v(()=>{if((t==null?void 0:t.labelPosition)==="top")return{};const r=ae(e.labelWidth||(t==null?void 0:t.labelWidth)||"");return r?{width:r}:{}}),B=v(()=>{if((t==null?void 0:t.labelPosition)==="top"||t!=null&&t.inline)return{};if(!e.label&&!e.labelWidth&&Ie)return{};const r=ae(e.labelWidth||(t==null?void 0:t.labelWidth)||"");return!e.label&&!c.label?{marginLeft:r}:{}}),o=v(()=>[f.b(),f.m(i.value),f.is("error",s.value==="error"),f.is("validating",s.value==="validating"),f.is("success",s.value==="success"),f.is("required",xe.value||e.required),f.is("no-asterisk",t==null?void 0:t.hideRequiredAsterisk),(t==null?void 0:t.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[f.m("feedback")]:t==null?void 0:t.statusIcon}]),n=v(()=>ve(e.inlineMessage)?e.inlineMessage:(t==null?void 0:t.inlineMessage)||!1),_=v(()=>[f.e("error"),{[f.em("error","inline")]:n.value}]),S=v(()=>e.prop?X(e.prop)?e.prop:e.prop.join("."):""),I=v(()=>!!(e.label||c.label)),j=v(()=>e.for||(g.value.length===1?g.value[0]:void 0)),q=v(()=>!j.value&&I.value),Ie=!!u,te=v(()=>{const r=t==null?void 0:t.model;if(!(!r||!e.prop))return D(r,e.prop).value}),T=v(()=>{const{required:r}=e,l=[];e.rules&&l.push(...J(e.rules));const h=t==null?void 0:t.rules;if(h&&e.prop){const m=D(h,e.prop).value;m&&l.push(...J(m))}if(r!==void 0){const m=l.map((F,A)=>[F,A]).filter(([F])=>Object.keys(F).includes("required"));if(m.length>0)for(const[F,A]of m)F.required!==r&&(l[A]={...F,required:r});else l.push({required:r})}return l}),Ee=v(()=>T.value.length>0),Ce=r=>T.value.filter(h=>!h.trigger||!r?!0:Array.isArray(h.trigger)?h.trigger.includes(r):h.trigger===r).map(({trigger:h,...m})=>m),xe=v(()=>T.value.some(r=>r.required)),Le=v(()=>{var r;return b.value==="error"&&e.showMessage&&((r=t==null?void 0:t.showMessage)!=null?r:!0)}),re=v(()=>"".concat(e.label||"").concat((t==null?void 0:t.labelSuffix)||"")),M=r=>{s.value=r},Be=r=>{var l,h;const{errors:m,fields:F}=r;M("error"),y.value=m?(h=(l=m==null?void 0:m[0])==null?void 0:l.message)!=null?h:"".concat(e.prop," is required"):"",t==null||t.emit("validate",e.prop,!1,y.value)},Me=()=>{M("success"),t==null||t.emit("validate",e.prop,!0,"")},Ae=async r=>{const l=S.value;return new Je({[l]:r}).validate({[l]:te.value},{firstFields:!0}).then(()=>(Me(),!0)).catch(m=>(Be(m),Promise.reject(m)))},le=async(r,l)=>{if(W||!e.prop)return!1;const h=ye(l);if(!Ee.value)return l==null||l(!1),!1;const m=Ce(r);return m.length===0?(l==null||l(!0),!0):(M("validating"),Ae(m).then(()=>(l==null||l(!0),!0)).catch(F=>{const{fields:A}=F;return l==null||l(!1,A),h?!1:Promise.reject(A)}))},k=()=>{M(""),y.value="",W=!1},oe=async()=>{const r=t==null?void 0:t.model;if(!r||!e.prop)return;const l=D(r,e.prop);W=!0,l.value=de(x),await Fe(),k(),W=!1},Oe=r=>{g.value.includes(r)||g.value.push(r)},Ne=r=>{g.value=g.value.filter(l=>l!==r)};$(()=>e.error,r=>{y.value=r||"",M(r?"error":"")},{immediate:!0}),$(()=>e.validateStatus,r=>M(r||""));const U=pe({...he(e),$el:C,size:i,validateState:s,labelId:E,inputIds:g,isGroup:q,hasLabel:I,addInputId:Oe,removeInputId:Ne,resetField:oe,clearValidate:k,validate:le});return me(K,U),_e(()=>{e.prop&&(t==null||t.addField(U),x=de(te.value))}),Se(()=>{t==null||t.removeField(U)}),p({size:i,validateMessage:y,validateState:s,validate:le,clearValidate:k,resetField:oe}),(r,l)=>{var h;return H(),be("div",{ref_key:"formItemRef",ref:C,class:O(d(o)),role:d(q)?"group":void 0,"aria-labelledby":d(q)?d(E):void 0},[z(d(dt),{"is-auto-width":d(w).width==="auto","update-all":((h=d(t))==null?void 0:h.labelWidth)==="auto"},{default:G(()=>[d(I)?(H(),ke(Ue(d(j)?"label":"div"),{key:0,id:d(E),for:d(j),class:O(d(f).e("label")),style:se(d(w))},{default:G(()=>[V(r.$slots,"label",{label:d(re)},()=>[De(ne(d(re)),1)])]),_:3},8,["id","for","class","style"])):ie("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),ue("div",{class:O(d(f).e("content")),style:se(d(B))},[V(r.$slots,"default"),z(Ge,{name:"".concat(d(f).namespace.value,"-zoom-in-top")},{default:G(()=>[d(Le)?V(r.$slots,"error",{key:0,error:y.value},()=>[ue("div",{class:O(d(_))},ne(y.value),3)]):ie("v-if",!0)]),_:3},8,["name"])],6)],10,ct)}}});var we=ge(vt,[["__file","form-item.vue"]]);const _t=Ke(nt,{FormItem:we}),St=Ye(we);export{St as E,_t as a,J as c};
