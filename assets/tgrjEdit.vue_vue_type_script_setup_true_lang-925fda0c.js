import{d as R,m as y,a as m,b as h,F as S,s as B,X as C,w as i,j as g,t as z,bu as H,f as q,af as P,o as ee,c5 as te,ao as G,c3 as E,bs as c,c6 as ne,b1 as oe,r,h as e,Z as ae,c7 as N,bt as j,ah as le,aO as $}from"./index-e6abbe05.js";/* empty css             */import{E as M}from"./tag-7126493f.js";import{E as se}from"./button-23219e73.js";import{E as ie}from"./index-10bd5ec9.js";const ce=g(" + New Tag "),ue=R({__name:"tags",props:{dynamicTags:{type:Array,default:()=>[]}},setup(I){const F=I,p=y(""),_=y(F.dynamicTags),v=y(!1),D=y(),O=V=>{_.value.splice(_.value.indexOf(V),1)},K=()=>{v.value=!0,P(()=>{D.value.input.focus()})},d=()=>{p.value&&_.value.push(p.value),v.value=!1,p.value=""};return(V,t)=>{const k=M,w=se;return m(),h(S,null,[(m(!0),h(S,null,B(_.value,o=>(m(),C(k,{key:o,class:"mx-1",closable:"","disable-transitions":!1,onClose:U=>O(o)},{default:i(()=>[g(z(o),1)]),_:2},1032,["onClose"]))),128)),v.value?(m(),C(q(ie),{key:0,ref_key:"InputRef",ref:D,modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=o=>p.value=o),class:"ml-1 w-20",size:"small",onKeyup:H(d,["enter"]),onBlur:d},null,8,["modelValue","onKeyup"])):(m(),C(w,{key:1,class:"button-new-tag ml-1",size:"small",onClick:K},{default:i(()=>[ce]),_:1}))],64)}}}),de={class:"p-4 px-12"},re=g("新增"),me=g("提交"),pe=g("重置"),ge=R({__name:"tgrjEdit",setup(I){ee(()=>{U()});const F=te(),p=y(),_=y(),v=y(),D=()=>{},O=a=>{t.content=a.content,t.contentTitle=d[a.type].content,t.dynamicTags.splice(0),t.dynamicTags.push(...a.tags),t.type=a.type,t.objectId=a.objectId,o.add=!0},K=async a=>{if(await N.modal.confirm("您确定要删除该数据?")==="confirm"){const u=v.value;j.Object.createWithoutData(c.FUCKDOG.name,a.objectId).destroy(),u.remove(a),N.modal.message({content:"删除成功。",status:"success"})}},d={fuckDog:{label:c.FUCKDOG.type.fuckDog,content:"甜狗日记"},sunnySaying:{label:c.FUCKDOG.type.sunnySaying,content:"阳光语录"},ikun:{label:c.FUCKDOG.type.ikun,content:"ikun（鸡你太美）"}},V=a=>{const n=a.data,u=j.Object.extend(c.FUCKDOG.name);let s=new u;t.objectId&&(s=j.Object.createWithoutData(c.FUCKDOG.name,t.objectId)),s.set(c.FUCKDOG.keys.type,n.type),s.set(c.FUCKDOG.keys.tags,t.dynamicTags),s.set(c.FUCKDOG.keys.content,n.content),s.set(c.FUCKDOG.keys.md5,le.MD5(n.content).toString()),s.addUnique(c.FUCKDOG.keys.like,$()().id),s.addUnique(c.FUCKDOG.keys.bookmark,$()().id),s.save().then(b=>{N.modal.message({content:"保存成功。",status:"success"}),p.value.close(),U()})},t=G({objectId:"",type:"fuckDog",dynamicTags:["fuckDog"],content:"",contentTitle:"舔狗日记"}),k=a=>{t.contentTitle=a.$radio.props.content,t.dynamicTags[0]=a.$radio.props.label},w=G({content:[{required:!0,message:"请输入..."},{min:1,max:5e3}]}),o=G({add:!1,filterName:"",tableData:[]}),U=()=>{const a=E()(c.FUCKDOG.name);a.contains("content",o.filterName);const n=E()(c.FUCKDOG.name);n.contains("type",o.filterName);const u=E()(c.FUCKDOG.name);u.contains("tags",o.filterName),ne()().or(a,n,u).find().then(s=>{o.tableData=s.map(b=>{const x=b.toJSON();return x.likeNum=x.like.length,x})})},A=oe.debounce(U,1e3);return(a,n)=>{const u=r("vxe-button"),s=r("vxe-form-item"),b=r("vxe-radio"),x=ue,J=r("vxe-textarea"),W=r("vxe-form"),X=r("vxe-modal"),L=r("vxe-input"),Q=r("vxe-toolbar"),f=r("vxe-column"),Y=M,Z=r("vxe-table");return m(),h("div",de,[e(Q,null,{buttons:i(()=>[e(u,{icon:"vxe-icon-square-plus",onClick:n[0]||(n[0]=l=>o.add=!0)},{default:i(()=>[re]),_:1}),e(X,{ref_key:"xModal",ref:p,modelValue:o.add,"onUpdate:modelValue":n[5]||(n[5]=l=>o.add=l),title:"舔狗日记投稿",width:"888","show-zoom":"",resize:""},{default:i(()=>[e(W,{ref_key:"xForm",ref:_,data:t,rules:w,"title-align":"right","title-width":"60",onSubmit:V,onReset:D},{default:i(()=>[e(s,{title:"欢迎各位舔狗分享自己的心酸历程","title-align":"left","title-width":"300px","title-prefix":{icon:"vxe-icon-question-circle-fill"}}),e(s,{title:"语录类型",field:"name",span:"24","title-colon":"","title-width":"100","item-render":{}},{default:i(()=>[e(b,{modelValue:t.type,"onUpdate:modelValue":n[1]||(n[1]=l=>t.type=l),label:d.fuckDog.label,content:d.fuckDog.content,onChange:k},null,8,["modelValue","label","content"]),e(b,{modelValue:t.type,"onUpdate:modelValue":n[2]||(n[2]=l=>t.type=l),label:d.sunnySaying.label,content:d.sunnySaying.content,onChange:k},null,8,["modelValue","label","content"]),e(b,{modelValue:t.type,"onUpdate:modelValue":n[3]||(n[3]=l=>t.type=l),label:d.ikun.label,content:d.ikun.content,onChange:k},null,8,["modelValue","label","content"])]),_:1}),e(s,{title:"标签",field:"tags",span:"24","title-colon":"","title-width":"100","item-render":{}},{default:i(()=>[e(x,{"dynamic-tags":t.dynamicTags},null,8,["dynamic-tags"])]),_:1}),e(s,{title:t.contentTitle,field:"content",span:"24","title-width":"100","title-colon":"","item-render":{}},{default:i(()=>[e(J,{modelValue:t.content,"onUpdate:modelValue":n[4]||(n[4]=l=>t.content=l),placeholder:"心路历程",rows:"6"},null,8,["modelValue"])]),_:1},8,["title"]),e(s,{align:"center",span:"24"},{default:i(()=>[e(u,{type:"submit",status:"primary"},{default:i(()=>[me]),_:1}),e(u,{type:"reset"},{default:i(()=>[pe]),_:1})]),_:1})]),_:1},8,["data","rules"])]),_:1},8,["modelValue"]),e(L,{modelValue:o.filterName,"onUpdate:modelValue":n[6]||(n[6]=l=>o.filterName=l),class:"pl-4",placeholder:"试试全表搜索",onKeyup:q(A)},null,8,["modelValue","onKeyup"])]),_:1}),e(Z,{ref_key:"xTable",ref:v,data:o.tableData},{default:i(()=>[e(f,{type:"seq",title:"序号",width:"60"}),e(f,{field:"content",title:"内容"}),e(f,{field:"type",title:"类型"}),e(f,{field:"tags",title:"标签"},{default:i(({row:l})=>[(m(!0),h(S,null,B(l.tags,T=>(m(),C(Y,{key:T,class:"mx-1","disable-transitions":!1},{default:i(()=>[g(z(T),1)]),_:2},1024))),128))]),_:1}),e(f,{field:"like",title:"like"}),e(f,{field:"likeNum",title:"likeNum"}),q(F)?(m(),C(f,{key:0,title:"操作",width:"100","show-overflow":""},{default:i(({row:l})=>[e(u,{type:"text",icon:"vxe-icon-edit",onClick:T=>O(l)},null,8,["onClick"]),e(u,{type:"text",icon:"vxe-icon-delete",onClick:T=>K(l)},null,8,["onClick"])]),_:1})):ae("",!0)]),_:1},8,["data"])])}}});export{ge as _};
