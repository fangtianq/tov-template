System.register(["./base-legacy.38854648.js","./button-legacy.dac9a932.js","./delete-legacy.25d41982.js","./input-legacy.13394860.js","./index-legacy.7a69c0b7.js","./request-legacy.d20290b8.js","./index-legacy.c83ba5f5.js"],(function(e,t){"use strict";var a,s,l,n,c,r,o,u,i,d,b,v,y,p,j,O,g,m,k,f,I,N,S,w,h,x;return{setters:[null,e=>{a=e.E},e=>{s=e._},null,e=>{l=e.d,n=e.X,c=e.P,r=e.e,o=e.h,u=e.i,i=e.a3,d=e.o,b=e.a,v=e.b,y=e.F,p=e.D,j=e.A,O=e.B,g=e.w,m=e.y,k=e.x,f=e.au,I=e.av,N=e.ae,S=e.af,w=e.v},e=>{h=e.a},e=>{x=e.E}],execute:function(){var t={class:"main p-4"},J={class:"message-container"},_=v("h3",null,"后台：org.sang.socket.livequery.LiveQueryController",-1),T=v("h3",null,"https://github.com/fangtianq/FTQPriSpringbootVueBlog",-1),D={class:"mdui-card-primary"},Q={class:"mdui-card-content message-content inline-block"},C={class:"inline-block"},V=l({__name:"liveQuery",setup(e){var l,V,q=n(c.REFDANMU),z={Authorization:"",ContentType:"text/LCObject"},A=null,B=r([]),E=()=>{A&&(i.success("liveQuery websocket重新连接成功..."),clearInterval(A),A=null),V=new f("/websocket"),(l=I.over(V)).connect(z,(()=>{i.success("liveQuery websocket连接成功..."),l.subscribe("/create",(e=>{B.value.push(JSON.parse(e.body))})),l.subscribe("/delete",(e=>{var t=JSON.parse(e.body).objectId;B.value=B.value.filter((e=>e.objectId!=t))})),l.subscribe("/update",(e=>{var t=JSON.parse(e.body).objectId,a=B.value.findIndex((e=>e.objectId==t));B.value[a]=JSON.parse(e.body),q.value.insert(JSON.parse(e.body).object)}))}),(e=>{A=setInterval((()=>{E()}),5e3),i.error("liveQuery websocket断线重连中...")})),h.post("/find",{className:N.TODO.name}).then((e=>{B.value=e.data.list}))};o((()=>{E()})),u((()=>{l.disconnect((()=>{V.onclose,V.close(),i.success("liveQuery websocket断开成功！")}))}));var F=()=>{var e=new(S.Object.extend(N.TODO.name));e.set(N.TODO.keys.content,"Hello world!"),e.set(N.TODO.keys.done,!0),e.set(N.TODO.keys.user,w()());var t=JSON.stringify({object:e.attributes,className:e.className});l.send("/app/saveInBackground",z,t)};return(e,n)=>{var c=x,r=s,o=a;return d(),b("div",t,[v("div",J,[_,T,(d(!0),b(y,null,p(m(B),(e=>(d(),b("div",{key:e.objectId,class:"mdui-card",style:{margin:"10px 0",width:"500px"}},[v("div",D,[v("div",Q,[j(O(e.object.user.username+"："),1),g(c,{modelValue:e.object.content,"onUpdate:modelValue":t=>e.object.content=t,clearable:"",onInput:t=>{return a=e.objectId,s=e.object,void l.send("/app/updateObject",z,JSON.stringify({objectId:a,object:s}));var a,s}},null,8,["modelValue","onUpdate:modelValue","onInput"])]),v("div",C,[g(r,{class:"relative top-1",onClick:t=>{return a=e.objectId,void l.send("/app/deleteObject",z,JSON.stringify({objectId:a}));var a}},null,8,["onClick"])])])])))),128)),g(o,{type:"primary",size:"default",onClick:F},{default:k((()=>[j("发送")])),_:1})])])}}}),q=Object.freeze(Object.defineProperty({__proto__:null,default:V},Symbol.toStringTag,{value:"Module"}));e("_",q)}}}));
